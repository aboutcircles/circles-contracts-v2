<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title></title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="book.css">

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item "><a href="index.html">Home</a></li><li class="chapter-item affix "><li class="part-title">src</li><li class="chapter-item "><a href="src/circles/index.html">‚ù± circles</a><a class="toggle"><div>‚ù±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="src/circles/Circles.sol/contract.Circles.html">Circles</a></li><li class="chapter-item "><a href="src/circles/Demurrage.sol/contract.Demurrage.html">Demurrage</a></li><li class="chapter-item "><a href="src/circles/DiscountedBalances.sol/contract.DiscountedBalances.html">DiscountedBalances</a></li><li class="chapter-item "><a href="src/circles/ERC1155.sol/abstract.ERC1155.html">ERC1155</a></li><li class="chapter-item "><a href="src/circles/ICircles.sol/interface.ICircles.html">ICircles</a></li><li class="chapter-item "><a href="src/circles/IDemurrage.sol/interface.IDemurrage.html">IDemurrage</a></li></ol></li><li class="chapter-item "><a href="src/errors/index.html">‚ù± errors</a><a class="toggle"><div>‚ù±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="src/errors/Errors.sol/interface.IHubErrors.html">IHubErrors</a></li><li class="chapter-item "><a href="src/errors/Errors.sol/interface.ICirclesDemurrageErrors.html">ICirclesDemurrageErrors</a></li><li class="chapter-item "><a href="src/errors/Errors.sol/interface.ICirclesErrors.html">ICirclesErrors</a></li><li class="chapter-item "><a href="src/errors/Errors.sol/interface.IStandardTreasuryErrors.html">IStandardTreasuryErrors</a></li><li class="chapter-item "><a href="src/errors/Errors.sol/interface.INameRegistryErrors.html">INameRegistryErrors</a></li></ol></li><li class="chapter-item "><a href="src/groups/index.html">‚ù± groups</a><a class="toggle"><div>‚ù±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="src/groups/BaseMintPolicy.sol/contract.MintPolicy.html">MintPolicy</a></li><li class="chapter-item "><a href="src/groups/Definitions.sol/contract.BaseMintPolicyDefinitions.html">BaseMintPolicyDefinitions</a></li><li class="chapter-item "><a href="src/groups/IMintPolicy.sol/interface.IMintPolicy.html">IMintPolicy</a></li></ol></li><li class="chapter-item "><a href="src/hub/index.html">‚ù± hub</a><a class="toggle"><div>‚ù±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="src/hub/Hub.sol/contract.Hub.html">Hub</a></li><li class="chapter-item "><a href="src/hub/IHub.sol/interface.IHubV2.html">IHubV2</a></li><li class="chapter-item "><a href="src/hub/TypeDefinitions.sol/contract.TypeDefinitions.html">TypeDefinitions</a></li></ol></li><li class="chapter-item "><a href="src/lib/index.html">‚ù± lib</a><a class="toggle"><div>‚ù±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="src/lib/Math64x64.sol/library.Math64x64.html">Math64x64</a></li></ol></li><li class="chapter-item "><a href="src/lift/index.html">‚ù± lift</a><a class="toggle"><div>‚ù±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="src/lift/DemurrageCircles.sol/contract.DemurrageCircles.html">DemurrageCircles</a></li><li class="chapter-item "><a href="src/lift/EIP712.sol/abstract.EIP712.html">EIP712</a></li><li class="chapter-item "><a href="src/lift/ERC20DiscountedBalances.sol/contract.ERC20DiscountedBalances.html">ERC20DiscountedBalances</a></li><li class="chapter-item "><a href="src/lift/ERC20InflationaryBalances.sol/contract.ERC20InflationaryBalances.html">ERC20InflationaryBalances</a></li><li class="chapter-item "><a href="src/lift/ERC20Lift.sol/contract.ERC20Lift.html">ERC20Lift</a></li><li class="chapter-item "><a href="src/lift/ERC20Permit.sol/contract.ERC20Permit.html">ERC20Permit</a></li><li class="chapter-item "><a href="src/lift/IERC20Lift.sol/enum.CirclesType.html">CirclesType</a></li><li class="chapter-item "><a href="src/lift/IERC20Lift.sol/interface.IERC20Lift.html">IERC20Lift</a></li><li class="chapter-item "><a href="src/lift/InflationaryCircles.sol/contract.InflationaryCircles.html">InflationaryCircles</a></li></ol></li><li class="chapter-item "><a href="src/migration/index.html">‚ù± migration</a><a class="toggle"><div>‚ù±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="src/migration/IHub.sol/interface.IHubV1.html">IHubV1</a></li><li class="chapter-item "><a href="src/migration/IToken.sol/interface.ITokenV1.html">ITokenV1</a></li><li class="chapter-item "><a href="src/migration/Migration.sol/contract.Migration.html">Migration</a></li></ol></li><li class="chapter-item "><a href="src/names/index.html">‚ù± names</a><a class="toggle"><div>‚ù±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="src/names/Base58Converter.sol/contract.Base58Converter.html">Base58Converter</a></li><li class="chapter-item "><a href="src/names/INameRegistry.sol/interface.INameRegistry.html">INameRegistry</a></li><li class="chapter-item "><a href="src/names/NameRegistry.sol/contract.NameRegistry.html">NameRegistry</a></li></ol></li><li class="chapter-item "><a href="src/operators/index.html">‚ù± operators</a><a class="toggle"><div>‚ù±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="src/operators/BaseOperator.sol/contract.BaseOperator.html">BaseOperator</a></li><li class="chapter-item "><a href="src/operators/SignedPathOperator.sol/contract.SignedPathOperator.html">SignedPathOperator</a></li></ol></li><li class="chapter-item "><a href="src/proxy/index.html">‚ù± proxy</a><a class="toggle"><div>‚ù±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="src/proxy/MasterCopyNonUpgradable.sol/contract.MasterCopyNonUpgradable.html">MasterCopyNonUpgradable</a></li><li class="chapter-item "><a href="src/proxy/Proxy.sol/interface.IProxy.html">IProxy</a></li><li class="chapter-item "><a href="src/proxy/Proxy.sol/contract.Proxy.html">Proxy</a></li><li class="chapter-item "><a href="src/proxy/ProxyFactory.sol/contract.ProxyFactory.html">ProxyFactory</a></li></ol></li><li class="chapter-item "><a href="src/treasury/index.html">‚ù± treasury</a><a class="toggle"><div>‚ù±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="src/treasury/IStandardVault.sol/interface.IStandardVault.html">IStandardVault</a></li><li class="chapter-item "><a href="src/treasury/StandardTreasury.sol/contract.StandardTreasury.html">StandardTreasury</a></li><li class="chapter-item "><a href="src/treasury/StandardVault.sol/contract.StandardVault.html">StandardVault</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/aboutcircles/circles-contracts-v2" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="circles-protocol"><a class="header" href="#circles-protocol">Circles Protocol</a></h1>
<h2 id="introducing-circles-protocol-v2"><a class="header" href="#introducing-circles-protocol-v2">Introducing Circles Protocol v2</a></h2>
<p>We're excited to be working on Circles Protocol v2, where we focus on making things better for everyone who uses and builds on Circles. Learning from our journey since Circles began, we've tackled the challenges we faced in the early days.</p>
<p>In Circles v2, we make it easier and more inviting for users and developers to engage with Circles. Our goal is to foster an ecosystem of products and experiences building on Circles. We've also been busy updating our technology, using the latest in cryptography to enhance performance, scalability, and to bring a new level of privacy to the Circles experience.</p>
<h2 id="why-build-circles-"><a class="header" href="#why-build-circles-">Why build Circles ?</a></h2>
<p>Our standard money system is based on debt, primarily from banks. Repaying this debt requires more than the initial amount due to interest, ensuring a consistent return of funds to these financial institutions. This system indirectly encourages anticipating future economic growth, which can increase our demand on the planet's resources.</p>
<p>In Circles UBI, we introduce "Time Circles" (TiC), a money system backed by the equal passage of time for all people. Every hour, each individual can seamlessly add one TiC to their account, unconditionally. To ensure TiC remains a meaningful measure of value, we implement a decay mechanism: tokens diminish in value over time. This equilibrium between token creation and decay ensures a stable balance for everyone, today and for future generations.</p>
<p>Understanding "Time Circles" also means recognizing what they are not. While this brief overview may not capture the full depth of the discussion, let's set a clear foundation from the outset.</p>
<p>Time Circles is not a panacea for all economic challenges, but it is essential to understand its intended purpose. TiC isn't a promise of a universal standard of living across diverse regions. Instead, it's a commitment that no person should be completely without financial means. Think of TC as a baseline currency available to all.</p>
<p>Time Circles encourages circular spending. Its true worth will be determined by the quality and range of goods and services available for TiC. While other currencies may prioritize store-of-value, TiC complements this financial landscape, emphasizing circulation and utility.</p>
<p>Lastly, two crucial parameters underpin the TiC system. The first parameter straightforwardly defines the unit: one token for every human, every hour. The second parameter establishes the decay rate of TiC. With a vision for sustainability across generations, our approach is retrospective: taking an optimistic human lifespan of 80 years as a benchmark, a token minted today should, after those 80 years, carry negligible value.</p>
<h2 id="specifications"><a class="header" href="#specifications">Specifications</a></h2>
<p>üêâ <strong>warning</strong>: here be dragons. This repository is under construction and neither functionally complete or externally reviewed. It is shared publicly to enable early discussion, but should not be considered ready for use.</p>
<p>For questions, contact maintainer: Ben <a href="mailto:benjamin.bollen@gnosis.io">benjamin.bollen@gnosis.io</a></p>
<h2 id="setting-up-development-environment"><a class="header" href="#setting-up-development-environment">Setting up development environment</a></h2>
<p>This Solidity project uses Foundry as a toolkit. If you don't have Foundry installed yet, see instructions <a href="index.html#foundry-as-toolkit">below</a></p>
<h3 id="using-foundry-to-build-the-contracts"><a class="header" href="#using-foundry-to-build-the-contracts">Using Foundry to build the contracts</a></h3>
<ol>
<li>First, you'll need to clone the repository to your local machine:
<pre><code class="language-bash">git clone https://github.com/CirclesUBI/circles-contracts-v2
cd circles-contracts-v2
</code></pre>
</li>
</ol>
<h3 id="compiling-the-contracts"><a class="header" href="#compiling-the-contracts">Compiling the contracts</a></h3>
<ol>
<li>
<p>To compile the contracts, use the following command:</p>
<pre><code class="language-bash">forge build
</code></pre>
<p>Upon successful compilation, you'll find the generated artifacts (like ABI and bytecode) in the specified output directory, by default  <code>out/</code>.</p>
</li>
<li>
<p>To format the code, you can run:</p>
<pre><code class="language-bash">forge fmt
</code></pre>
<p>or only check the correct formatting without changing the code:</p>
<pre><code class="language-bash">forge fmt --check
</code></pre>
</li>
</ol>
<h3 id="testing-the-contracts"><a class="header" href="#testing-the-contracts">Testing the contracts</a></h3>
<ol>
<li>To test the contracts, use the following command:
<pre><code class="language-bash">forge test
</code></pre>
or to report on gas usage:
<pre><code class="language-bash">forge test --gas-report
</code></pre>
</li>
<li>To create a snapshot file to disk of each test's gas usage, use:
<pre><code class="language-bash">forge snapshot
</code></pre>
</li>
</ol>
<h3 id="deploying-the-contracts"><a class="header" href="#deploying-the-contracts">Deploying the contracts</a></h3>
<h4 id="chiado"><a class="header" href="#chiado">Chiado</a></h4>
<p>To deploy the contracts to the Chiado testnet, run <code>./chiadoDeploy.sh</code> and supply a private key and API keys in <code>.env</code> file in the root directory (copy <code>.env.example</code> and set private information):</p>
<pre><code class="language-shell">./script/deployments/chiadoDeploy.sh
</code></pre>
<h2 id="foundry-as-toolkit"><a class="header" href="#foundry-as-toolkit">Foundry as toolkit</a></h2>
<p>Foundry consists of:</p>
<ul>
<li><strong>Forge</strong>: Ethereum testing framework (like Truffle, Hardhat and DappTools).</li>
<li><strong>Cast</strong>: Swiss army knife for interacting with EVM smart contracts, sending transactions and getting chain data.</li>
<li><strong>Anvil</strong>: Local Ethereum node, akin to Ganache, Hardhat Network.</li>
<li><strong>Chisel</strong>: Fast, utilitarian, and verbose solidity REPL.</li>
</ul>
<p>You can find the installation guide for Foundry in their <a href="https://book.getfoundry.sh/getting-started/installation">book.getfoundry.sh - Getting started</a></p>
<p>Here we re-iterate the most important steps to get you started.</p>
<ol>
<li>You can install precompiled binaries with their toolchain installer:
<pre><code class="language-bash">curl -L https://foundry.paradigm.xyz | bash
</code></pre>
and follow the instructions in the terminal.
To instead build from source, see their getting started guide.</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents"><a class="header" href="#contents">Contents</a></h1>
<ul>
<li><a href="src/circles/Circles.sol/contract.Circles.html">Circles</a></li>
<li><a href="src/circles/Demurrage.sol/contract.Demurrage.html">Demurrage</a></li>
<li><a href="src/circles/DiscountedBalances.sol/contract.DiscountedBalances.html">DiscountedBalances</a></li>
<li><a href="src/circles/ERC1155.sol/abstract.ERC1155.html">ERC1155</a></li>
<li><a href="src/circles/ICircles.sol/interface.ICircles.html">ICircles</a></li>
<li><a href="src/circles/IDemurrage.sol/interface.IDemurrage.html">IDemurrage</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="circles"><a class="header" href="#circles">Circles</a></h1>
<p><a href="https://github.com/aboutcircles/circles-contracts-v2/blob/9fbbffb44eda7934ea8adf9354e5f09f6b15b8b2/src/circles/Circles.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="src/circles/Circles.sol//src/circles/ERC1155.sol/abstract.ERC1155.html">ERC1155</a>, <a href="src/circles/Circles.sol//src/errors/Errors.sol/interface.ICirclesErrors.html">ICirclesErrors</a></p>
<h2 id="state-variables"><a class="header" href="#state-variables">State Variables</a></h2>
<h3 id="issuance_per_second"><a class="header" href="#issuance_per_second">ISSUANCE_PER_SECOND</a></h3>
<p>Issue one Circle per hour for each human in demurraged units.
So per second issue 10**18 / 3600 = 277777777777778 attoCircles.</p>
<pre><code class="language-solidity">uint256 private constant ISSUANCE_PER_SECOND = uint256(277777777777778);
</code></pre>
<h3 id="max_claim_duration"><a class="header" href="#max_claim_duration">MAX_CLAIM_DURATION</a></h3>
<p>Upon claiming, the maximum claim is upto two weeks
of history. Unclaimed older Circles are unclaimable.</p>
<pre><code class="language-solidity">uint256 private constant MAX_CLAIM_DURATION = 2 weeks;
</code></pre>
<h3 id="circles_stopped_v1"><a class="header" href="#circles_stopped_v1">CIRCLES_STOPPED_V1</a></h3>
<p><em>Address used to indicate that the associated v1 Circles contract has been stopped.</em></p>
<pre><code class="language-solidity">address internal constant CIRCLES_STOPPED_V1 = address(0x1);
</code></pre>
<h3 id="indefinite_future"><a class="header" href="#indefinite_future">INDEFINITE_FUTURE</a></h3>
<p>Indefinite future, or approximated with uint96.max</p>
<pre><code class="language-solidity">uint96 internal constant INDEFINITE_FUTURE = type(uint96).max;
</code></pre>
<h3 id="minttimes"><a class="header" href="#minttimes">mintTimes</a></h3>
<p>The mapping of avatar addresses to the last mint time,
and the status of the v1 Circles minting.</p>
<p><em>This is used to store the last mint time for each avatar.</em></p>
<pre><code class="language-solidity">mapping(address =&gt; MintTime) internal mintTimes;
</code></pre>
<h2 id="functions"><a class="header" href="#functions">Functions</a></h2>
<h3 id="constructor"><a class="header" href="#constructor">constructor</a></h3>
<p>Constructor to create a Circles ERC1155 contract with demurrage.</p>
<pre><code class="language-solidity">constructor(uint256 _inflation_day_zero, string memory _uri) ERC1155(_uri) DiscountedBalances(_inflation_day_zero);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_inflation_day_zero</code></td><td><code>uint256</code></td><td>Inflation day zero stores the start of the global inflation curve</td></tr>
<tr><td><code>_uri</code></td><td><code>string</code></td><td>uri for the Circles metadata</td></tr>
</tbody></table>
</div>
<h3 id="calculateissuance"><a class="header" href="#calculateissuance">calculateIssuance</a></h3>
<p>Calculate the demurraged issuance for a human's avatar.</p>
<pre><code class="language-solidity">function calculateIssuance(address _human) public view returns (uint256, uint256, uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_human</code></td><td><code>address</code></td><td>Address of the human's avatar to calculate the issuance for.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>issuance The issuance in attoCircles.</td></tr>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>startPeriod The start of the claimable period.</td></tr>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>endPeriod The end of the claimable period.</td></tr>
</tbody></table>
</div>
<h3 id="inflationarybalanceof"><a class="header" href="#inflationarybalanceof">inflationaryBalanceOf</a></h3>
<p>Inflationary balance of an account for a Circles identifier. Careful,
calculating the inflationary balance can introduce numerical errors
in the least significant digits (order of few attoCircles).</p>
<pre><code class="language-solidity">function inflationaryBalanceOf(address _account, uint256 _id) public view returns (uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_account</code></td><td><code>address</code></td><td>Address for which the balance is queried.</td></tr>
<tr><td><code>_id</code></td><td><code>uint256</code></td><td>Circles identifier for which the balance is queried.</td></tr>
</tbody></table>
</div>
<h3 id="safeinflationarytransferfrom"><a class="header" href="#safeinflationarytransferfrom">safeInflationaryTransferFrom</a></h3>
<p>safeInflationaryTransferFrom transfers Circles from one address to another by specifying inflationary units.</p>
<pre><code class="language-solidity">function safeInflationaryTransferFrom(
    address _from,
    address _to,
    uint256 _id,
    uint256 _inflationaryValue,
    bytes memory _data
) public;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_from</code></td><td><code>address</code></td><td>Address from which the Circles are transferred.</td></tr>
<tr><td><code>_to</code></td><td><code>address</code></td><td>Address to which the Circles are transferred.</td></tr>
<tr><td><code>_id</code></td><td><code>uint256</code></td><td>Circles indentifier for which the Circles are transferred.</td></tr>
<tr><td><code>_inflationaryValue</code></td><td><code>uint256</code></td><td>Inflationary value of the Circles transferred.</td></tr>
<tr><td><code>_data</code></td><td><code>bytes</code></td><td>Data to pass to the receiver.</td></tr>
</tbody></table>
</div>
<h3 id="safeinflationarybatchtransferfrom"><a class="header" href="#safeinflationarybatchtransferfrom">safeInflationaryBatchTransferFrom</a></h3>
<p>safeInflationaryBatchTransferFrom transfers Circles from one address to another by specifying inflationary units.</p>
<pre><code class="language-solidity">function safeInflationaryBatchTransferFrom(
    address _from,
    address _to,
    uint256[] memory _ids,
    uint256[] memory _inflationaryValues,
    bytes memory _data
) public;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_from</code></td><td><code>address</code></td><td>Address from which the Circles are transferred.</td></tr>
<tr><td><code>_to</code></td><td><code>address</code></td><td>Address to which the Circles are transferred.</td></tr>
<tr><td><code>_ids</code></td><td><code>uint256[]</code></td><td>Batch of Circles identifiers for which the Circles are transferred.</td></tr>
<tr><td><code>_inflationaryValues</code></td><td><code>uint256[]</code></td><td>Batch of inflationary values of the Circles transferred.</td></tr>
<tr><td><code>_data</code></td><td><code>bytes</code></td><td>Data to pass to the receiver.</td></tr>
</tbody></table>
</div>
<h3 id="_claimissuance"><a class="header" href="#_claimissuance">_claimIssuance</a></h3>
<p>Claim issuance for a human's avatar and update the last mint time.</p>
<pre><code class="language-solidity">function _claimIssuance(address _human) internal;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_human</code></td><td><code>address</code></td><td>Address of the human's avatar to claim the issuance for.</td></tr>
</tbody></table>
</div>
<h3 id="_mintandupdatetotalsupply"><a class="header" href="#_mintandupdatetotalsupply">_mintAndUpdateTotalSupply</a></h3>
<pre><code class="language-solidity">function _mintAndUpdateTotalSupply(address _account, uint256 _id, uint256 _value, bytes memory _data) internal;
</code></pre>
<h3 id="_burnandupdatetotalsupply"><a class="header" href="#_burnandupdatetotalsupply">_burnAndUpdateTotalSupply</a></h3>
<pre><code class="language-solidity">function _burnAndUpdateTotalSupply(address _account, uint256 _id, uint256 _value) internal;
</code></pre>
<h3 id="_max"><a class="header" href="#_max">_max</a></h3>
<p><em>Max function to compare two values.</em></p>
<pre><code class="language-solidity">function _max(uint256 a, uint256 b) private pure returns (uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>a</code></td><td><code>uint256</code></td><td>Value a</td></tr>
<tr><td><code>b</code></td><td><code>uint256</code></td><td>Value b</td></tr>
</tbody></table>
</div>
<h2 id="events"><a class="header" href="#events">Events</a></h2>
<h3 id="personalmint"><a class="header" href="#personalmint">PersonalMint</a></h3>
<pre><code class="language-solidity">event PersonalMint(address indexed human, uint256 amount, uint256 startPeriod, uint256 endPeriod);
</code></pre>
<h2 id="structs"><a class="header" href="#structs">Structs</a></h2>
<h3 id="minttime"><a class="header" href="#minttime">MintTime</a></h3>
<p>MintTime struct stores the last mint time,
and the status of a connected v1 Circles contract.</p>
<p><em>This is used to store the last mint time for each avatar,
and the address is used as a status for the connected v1 Circles contract.
The address is kept at zero address if the avatar is not registered in Hub v1.
If the avatar is registered in Hub v1, but the associated Circles ERC20 contract
has not been stopped, then the address is set to that v1 Circles contract address.
Once the Circles v1 contract has been stopped, the address is set to 0x01.
At every observed transition of the status of the v1 Circles contract,
the lastMintTime will be updated to the current timestamp to avoid possible
overlap of the mint between Hub v1 and Hub v2.</em></p>
<pre><code class="language-solidity">struct MintTime {
    address mintV1Status;
    uint96 lastMintTime;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="demurrage"><a class="header" href="#demurrage">Demurrage</a></h1>
<p><a href="https://github.com/aboutcircles/circles-contracts-v2/blob/9fbbffb44eda7934ea8adf9354e5f09f6b15b8b2/src/circles/Demurrage.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="src/circles/Demurrage.sol//src/errors/Errors.sol/interface.ICirclesDemurrageErrors.html">ICirclesDemurrageErrors</a></p>
<h2 id="state-variables-1"><a class="header" href="#state-variables-1">State Variables</a></h2>
<h3 id="demurrage_window"><a class="header" href="#demurrage_window">DEMURRAGE_WINDOW</a></h3>
<p>Demurrage window reduces the resolution for calculating
the demurrage of balances from once per second (block.timestamp)
to once per day.</p>
<pre><code class="language-solidity">uint256 private constant DEMURRAGE_WINDOW = 1 days;
</code></pre>
<h3 id="max_value"><a class="header" href="#max_value">MAX_VALUE</a></h3>
<p><em>Maximum value that can be stored or transferred</em></p>
<pre><code class="language-solidity">uint256 internal constant MAX_VALUE = type(uint192).max;
</code></pre>
<h3 id="gamma_64x64"><a class="header" href="#gamma_64x64">GAMMA_64x64</a></h3>
<p><em>Reduction factor GAMMA for applying demurrage to balances
demurrage_balance(d) = GAMMA^d * inflationary_balance
where 'd' is expressed in days (DEMURRAGE_WINDOW) since demurrage_day_zero,
and GAMMA &lt; 1.
GAMMA_64x64 stores the numerator for the signed 128bit 64.64
fixed decimal point expression:
GAMMA = GAMMA_64x64 / 2**64.
To obtain GAMMA for a daily accounting of 7% p.a. demurrage
=&gt; GAMMA = (0.93)^(1/365.25)
= 0.99980133200859895743...
and expressed in 64.64 fixed point representation:
=&gt; GAMMA_64x64 = 18443079296116538654
For more details, see ./specifications/TCIP009-demurrage.md</em></p>
<pre><code class="language-solidity">int128 internal constant GAMMA_64x64 = int128(18443079296116538654);
</code></pre>
<h3 id="beta_64x64"><a class="header" href="#beta_64x64">BETA_64x64</a></h3>
<p><em>For calculating the inflationary mint amount on day <code>d</code>
since demurrage_day_zero, a person can mint
(1/GAMMA)^d CRC / hour
As GAMMA is a constant, to save gas costs store the inverse
as BETA = 1 / GAMMA.
BETA_64x64 is the 64.64 fixed point representation:
BETA_64x64 = 2**64 / ((0.93)^(1/365.25))
= 18450409579521241655
For more details, see ./specifications/TCIP009-demurrage.md</em></p>
<pre><code class="language-solidity">int128 internal constant BETA_64x64 = int128(18450409579521241655);
</code></pre>
<h3 id="decimals"><a class="header" href="#decimals">DECIMALS</a></h3>
<p><em>ERC1155 tokens MUST be 18 decimals.</em></p>
<pre><code class="language-solidity">uint8 internal constant DECIMALS = uint8(18);
</code></pre>
<h3 id="exa"><a class="header" href="#exa">EXA</a></h3>
<p><em>EXA factor as 10^18</em></p>
<pre><code class="language-solidity">uint256 internal constant EXA = uint256(10 ** DECIMALS);
</code></pre>
<h3 id="one_64x64"><a class="header" href="#one_64x64">ONE_64x64</a></h3>
<p><em>Store the signed 128-bit 64.64 representation of 1 as a constant</em></p>
<pre><code class="language-solidity">int128 internal constant ONE_64x64 = int128(2 ** 64);
</code></pre>
<h3 id="r_table_lookup"><a class="header" href="#r_table_lookup">R_TABLE_LOOKUP</a></h3>
<pre><code class="language-solidity">uint8 internal constant R_TABLE_LOOKUP = uint8(14);
</code></pre>
<h3 id="inflationdayzero"><a class="header" href="#inflationdayzero">inflationDayZero</a></h3>
<p>Inflation day zero stores the start of the global inflation curve
As Circles Hub v1 was deployed on Thursday 15th October 2020 at 6:25:30 pm UTC,
or 1602786330 unix time, in production this value MUST be set to 1602720000 unix time,
or midnight prior of the same day of deployment, marking the start of the first day
where there was no inflation on one CRC per hour.</p>
<pre><code class="language-solidity">uint256 public inflationDayZero;
</code></pre>
<h3 id="t"><a class="header" href="#t">T</a></h3>
<p><em>Store a lookup table T(n) for computing issuance.
T is only accessed for minting in Hub.sol, so it is initialized in
storage of Hub.sol during the constructor, by copying these values.
(It is not properly intialized in a ERC20 Proxy contract, but we never need
to access it there, so it is not a problem - it is only initialized in the
storage of the mastercopy during deployment.)
See ../../specifications/TCIP009-demurrage.md for more details.</em></p>
<pre><code class="language-solidity">int128[15] internal T = [
    int128(442721857769029238784),
    int128(885355760875826166476),
    int128(1327901726794166863126),
    int128(1770359772994355928788),
    int128(2212729916943227173193),
    int128(2655012176104144305282),
    int128(3097206567937001622606),
    int128(3539313109898224700583),
    int128(3981331819440771081628),
    int128(4423262714014130964135),
    int128(4865105811064327891331),
    int128(5306861128033919439986),
    int128(5748528682361997908993),
    int128(6190108491484191007805),
    int128(6631600572832662544739)
];
</code></pre>
<h3 id="r"><a class="header" href="#r">R</a></h3>
<p><em>Store a lookup table R(n) for computing issuance and demurrage.
This table is computed in the constructor of Hub.sol and mastercopy deployments,
and lazily computed in the ERC20 Demurrage proxy contracts, then cached into their storage.
The non-trivial situation for R(n) (vs T(n)) is that R is accessed
from the ERC20 Demurrage proxy contracts, so their storage will not yet
have been initialized with the constructor. (Counter to T which is only
accessed for minting in Hub.sol, and as such initialized in the constructor
of Hub.sol by Solidity by copying the python calculated values stored above.)
Computing R in contract is done with .64bits precision, whereas the python computed
table is slightly more accurate, but equal within dust (10^-18). See unit tests.
However, we want to ensure that Hub.sol and the ERC20 Demurrage proxy contracts
use the exact same R values (even if the difference would not matter).
So for R we rely on the in-contract computed values.
In the unit tests, the table of python computed values is stored in HIGHER_ACCURACY_R,
and matched against the solidity computed values.
See ../../specifications/TCIP009-demurrage.md for more details.</em></p>
<pre><code class="language-solidity">int128[15] internal R;
</code></pre>
<h2 id="functions-1"><a class="header" href="#functions-1">Functions</a></h2>
<h3 id="constructor-1"><a class="header" href="#constructor-1">constructor</a></h3>
<pre><code class="language-solidity">constructor();
</code></pre>
<h3 id="day"><a class="header" href="#day">day</a></h3>
<p>Calculate the day since inflation_day_zero for a given timestamp.</p>
<pre><code class="language-solidity">function day(uint256 _timestamp) public view returns (uint64);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_timestamp</code></td><td><code>uint256</code></td><td>Timestamp for which to calculate the day since inflation_day_zero.</td></tr>
</tbody></table>
</div>
<h3 id="totokenid"><a class="header" href="#totokenid">toTokenId</a></h3>
<p>Casts an avatar address to a tokenId uint256.</p>
<pre><code class="language-solidity">function toTokenId(address _avatar) public pure returns (uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_avatar</code></td><td><code>address</code></td><td>avatar address to convert to tokenId</td></tr>
</tbody></table>
</div>
<h3 id="convertinflationarytodemurragevalue"><a class="header" href="#convertinflationarytodemurragevalue">convertInflationaryToDemurrageValue</a></h3>
<p>Converts an inflationary value to a demurrage value for a given day since inflation_day_zero.</p>
<pre><code class="language-solidity">function convertInflationaryToDemurrageValue(uint256 _inflationaryValue, uint64 _day) public pure returns (uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_inflationaryValue</code></td><td><code>uint256</code></td><td>Inflationary value to convert to demurrage value.</td></tr>
<tr><td><code>_day</code></td><td><code>uint64</code></td><td>Day since inflation_day_zero to convert the inflationary value to a demurrage value.</td></tr>
</tbody></table>
</div>
<h3 id="convertbatchinflationarytodemurragevalues"><a class="header" href="#convertbatchinflationarytodemurragevalues">convertBatchInflationaryToDemurrageValues</a></h3>
<p>Converts a batch of inflationary values to demurrage values for a given day since inflation_day_zero.</p>
<pre><code class="language-solidity">function convertBatchInflationaryToDemurrageValues(uint256[] memory _inflationaryValues, uint64 _day)
    public
    pure
    returns (uint256[] memory);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_inflationaryValues</code></td><td><code>uint256[]</code></td><td>Batch of inflationary values to convert to demurrage values.</td></tr>
<tr><td><code>_day</code></td><td><code>uint64</code></td><td>Day since inflation_day_zero to convert the inflationary values to demurrage values.</td></tr>
</tbody></table>
</div>
<h3 id="_calculatediscountedbalance"><a class="header" href="#_calculatediscountedbalance">_calculateDiscountedBalance</a></h3>
<p><em>Calculates the discounted balance given a number of days to discount</em></p>
<pre><code class="language-solidity">function _calculateDiscountedBalance(uint256 _balance, uint256 _daysDifference) internal view returns (uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_balance</code></td><td><code>uint256</code></td><td>balance to calculate the discounted balance of</td></tr>
<tr><td><code>_daysDifference</code></td><td><code>uint256</code></td><td>days of difference between the last updated day and the day of interest</td></tr>
</tbody></table>
</div>
<h3 id="_calculatediscountedbalanceandcache"><a class="header" href="#_calculatediscountedbalanceandcache">_calculateDiscountedBalanceAndCache</a></h3>
<pre><code class="language-solidity">function _calculateDiscountedBalanceAndCache(uint256 _balance, uint256 _daysDifference) internal returns (uint256);
</code></pre>
<h3 id="_calculatedemurragefactor"><a class="header" href="#_calculatedemurragefactor">_calculateDemurrageFactor</a></h3>
<pre><code class="language-solidity">function _calculateDemurrageFactor(uint256 _dayDifference) internal view returns (int128);
</code></pre>
<h3 id="_calculatedemurragefactorandcache"><a class="header" href="#_calculatedemurragefactorandcache">_calculateDemurrageFactorAndCache</a></h3>
<pre><code class="language-solidity">function _calculateDemurrageFactorAndCache(uint256 _dayDifference) internal returns (int128);
</code></pre>
<h3 id="_calculateinflationarybalance"><a class="header" href="#_calculateinflationarybalance">_calculateInflationaryBalance</a></h3>
<p>Calculate the inflationary balance of a demurraged balance</p>
<pre><code class="language-solidity">function _calculateInflationaryBalance(uint256 _balance, uint256 _dayUpdated) internal pure returns (uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_balance</code></td><td><code>uint256</code></td><td>Demurraged balance to calculate the inflationary balance of</td></tr>
<tr><td><code>_dayUpdated</code></td><td><code>uint256</code></td><td>The day the balance was last updated</td></tr>
</tbody></table>
</div>
<h2 id="events-1"><a class="header" href="#events-1">Events</a></h2>
<h3 id="discountcost"><a class="header" href="#discountcost">DiscountCost</a></h3>
<pre><code class="language-solidity">event DiscountCost(address indexed account, uint256 indexed id, uint256 discountCost);
</code></pre>
<h2 id="structs-1"><a class="header" href="#structs-1">Structs</a></h2>
<h3 id="discountedbalance"><a class="header" href="#discountedbalance">DiscountedBalance</a></h3>
<p><em>Discounted balance with a last updated timestamp.
Note: The balance is stored as a 192-bit unsigned integer.
The last updated timestamp is stored as a 64-bit unsigned integer counting the days
since <code>inflation_day_zero</code> (for elegance, to not start the clock in 1970 with unix time).
We ensure that they combine to 32 bytes for a single Ethereum storage slot.
Note: The maximum total supply of CRC is <del>10^5 per human, with 10<strong>10 humans,
so even if all humans would pool all their tokens into a single group and then a single account
the total resolution required is 10^(10 + 5 + 18) = 10^33 &lt;&lt; 10</strong>57 (</del> max uint192).</em></p>
<pre><code class="language-solidity">struct DiscountedBalance {
    uint192 balance;
    uint64 lastUpdatedDay;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="discountedbalances"><a class="header" href="#discountedbalances">DiscountedBalances</a></h1>
<p><a href="https://github.com/aboutcircles/circles-contracts-v2/blob/9fbbffb44eda7934ea8adf9354e5f09f6b15b8b2/src/circles/DiscountedBalances.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="src/circles/DiscountedBalances.sol//src/circles/Demurrage.sol/contract.Demurrage.html">Demurrage</a></p>
<h2 id="state-variables-2"><a class="header" href="#state-variables-2">State Variables</a></h2>
<h3 id="discountedbalances-1"><a class="header" href="#discountedbalances-1">discountedBalances</a></h3>
<p><em>stores the discounted balances of the accounts privately.
Mapping from Circles identifiers to accounts to the discounted balance.</em></p>
<pre><code class="language-solidity">mapping(uint256 =&gt; mapping(address =&gt; DiscountedBalance)) internal discountedBalances;
</code></pre>
<h3 id="discountedtotalsupplies"><a class="header" href="#discountedtotalsupplies">discountedTotalSupplies</a></h3>
<p><em>stores the total supply for each Circles identifier</em></p>
<pre><code class="language-solidity">mapping(uint256 =&gt; DiscountedBalance) internal discountedTotalSupplies;
</code></pre>
<h2 id="functions-2"><a class="header" href="#functions-2">Functions</a></h2>
<h3 id="constructor-2"><a class="header" href="#constructor-2">constructor</a></h3>
<p><em>Constructor to set the start of the global inflationary curve.</em></p>
<pre><code class="language-solidity">constructor(uint256 _inflation_day_zero);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_inflation_day_zero</code></td><td><code>uint256</code></td><td>Timestamp of midgnight day zero for the global inflationary curve.</td></tr>
</tbody></table>
</div>
<h3 id="balanceofonday"><a class="header" href="#balanceofonday">balanceOfOnDay</a></h3>
<p>Balance of a Circles identifier for a given account on a (future) day.</p>
<pre><code class="language-solidity">function balanceOfOnDay(address _account, uint256 _id, uint64 _day)
    public
    view
    returns (uint256 balanceOnDay_, uint256 discountCost_);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_account</code></td><td><code>address</code></td><td>Address of the account to calculate the balance of</td></tr>
<tr><td><code>_id</code></td><td><code>uint256</code></td><td>Circles identifier for which to calculate the balance</td></tr>
<tr><td><code>_day</code></td><td><code>uint64</code></td><td>Day since inflation_day_zero to calculate the balance for</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>balanceOnDay_</code></td><td><code>uint256</code></td><td>The discounted balance of the account for the Circles identifier on specified day</td></tr>
<tr><td><code>discountCost_</code></td><td><code>uint256</code></td><td>The discount cost of the demurrage of the balance since the last update</td></tr>
</tbody></table>
</div>
<h3 id="totalsupply"><a class="header" href="#totalsupply">totalSupply</a></h3>
<p>Total supply of a Circles identifier.</p>
<pre><code class="language-solidity">function totalSupply(uint256 _id) public view returns (uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_id</code></td><td><code>uint256</code></td><td>Circles identifier for which to calculate the total supply</td></tr>
</tbody></table>
</div>
<h3 id="_inflationarybalanceof"><a class="header" href="#_inflationarybalanceof">_inflationaryBalanceOf</a></h3>
<p><em>Calculate the inflationary balance of a discounted balance</em></p>
<pre><code class="language-solidity">function _inflationaryBalanceOf(address _account, uint256 _id) internal view returns (uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_account</code></td><td><code>address</code></td><td>Address of the account to calculate the balance of</td></tr>
<tr><td><code>_id</code></td><td><code>uint256</code></td><td>Circles identifier for which to calculate the balance</td></tr>
</tbody></table>
</div>
<h3 id="_updatebalance"><a class="header" href="#_updatebalance">_updateBalance</a></h3>
<p><em>Update the balance of an account for a given Circles identifier</em></p>
<pre><code class="language-solidity">function _updateBalance(address _account, uint256 _id, uint256 _balance, uint64 _day) internal;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_account</code></td><td><code>address</code></td><td>Address of the account to update the balance of</td></tr>
<tr><td><code>_id</code></td><td><code>uint256</code></td><td>Circles identifier for which to update the balance</td></tr>
<tr><td><code>_balance</code></td><td><code>uint256</code></td><td>New balance to set</td></tr>
<tr><td><code>_day</code></td><td><code>uint64</code></td><td>Day since inflation_day_zero to set as last updated day</td></tr>
</tbody></table>
</div>
<h3 id="_discountandaddtobalance"><a class="header" href="#_discountandaddtobalance">_discountAndAddToBalance</a></h3>
<p><em>Discount to the given day and add to the balance of an account for a given Circles identifier</em></p>
<pre><code class="language-solidity">function _discountAndAddToBalance(address _account, uint256 _id, uint256 _value, uint64 _day) internal;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_account</code></td><td><code>address</code></td><td>Address of the account to update the balance of</td></tr>
<tr><td><code>_id</code></td><td><code>uint256</code></td><td>Circles identifier for which to update the balance</td></tr>
<tr><td><code>_value</code></td><td><code>uint256</code></td><td>Value to add to the discounted balance</td></tr>
<tr><td><code>_day</code></td><td><code>uint64</code></td><td>Day since inflation_day_zero to discount the balance to</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="erc1155"><a class="header" href="#erc1155">ERC1155</a></h1>
<p><a href="https://github.com/aboutcircles/circles-contracts-v2/blob/9fbbffb44eda7934ea8adf9354e5f09f6b15b8b2/src/circles/ERC1155.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="src/circles/ERC1155.sol//src/circles/DiscountedBalances.sol/contract.DiscountedBalances.html">DiscountedBalances</a>, Context, ERC165, IERC1155, IERC1155MetadataURI, IERC1155Errors</p>
<p><em>Implementation of the basic standard multi-token for demurraged and inflationary balances.
See https://eips.ethereum.org/EIPS/eip-1155
This code is modified from the open-zeppelin implementation v5.0.0:
https://github.com/OpenZeppelin/openzeppelin-contracts/
Originally based on code by Enjin: https://github.com/enjin/erc-1155</em></p>
<h2 id="state-variables-3"><a class="header" href="#state-variables-3">State Variables</a></h2>
<h3 id="_operatorapprovals"><a class="header" href="#_operatorapprovals">_operatorApprovals</a></h3>
<pre><code class="language-solidity">mapping(address account =&gt; mapping(address operator =&gt; bool)) private _operatorApprovals;
</code></pre>
<h3 id="_uri"><a class="header" href="#_uri">_uri</a></h3>
<pre><code class="language-solidity">string private _uri;
</code></pre>
<h2 id="functions-3"><a class="header" href="#functions-3">Functions</a></h2>
<h3 id="constructor-3"><a class="header" href="#constructor-3">constructor</a></h3>
<p><em>See <a href="src/circles/ERC1155.sol//src/circles/ERC1155.sol/abstract.ERC1155.html#_seturi">_setURI</a>.</em></p>
<pre><code class="language-solidity">constructor(string memory _newuri);
</code></pre>
<h3 id="supportsinterface"><a class="header" href="#supportsinterface">supportsInterface</a></h3>
<p><em>See <a href="src/circles/ERC1155.sol//src/treasury/StandardTreasury.sol/contract.StandardTreasury.html#supportsinterface">IERC165-supportsInterface</a>.</em></p>
<pre><code class="language-solidity">function supportsInterface(bytes4 _interfaceId) public view virtual override(ERC165, IERC165) returns (bool);
</code></pre>
<h3 id="uri"><a class="header" href="#uri">uri</a></h3>
<p><em>See <a href="src/circles/ERC1155.sol//lib/openzeppelin-contracts/contracts/token/ERC1155/ERC1155.sol/abstract.ERC1155.html#uri">IERC1155MetadataURI-uri</a>.
This implementation returns the same URI for <em>all</em> token types. It relies
on the token type ID substitution mechanism
https://eips.ethereum.org/EIPS/eip-1155#metadata[defined in the EIP].
Clients calling this function must replace the <code>\{id\}</code> substring with the
actual token type ID.</em></p>
<pre><code class="language-solidity">function uri(uint256) public view virtual returns (string memory);
</code></pre>
<h3 id="balanceof"><a class="header" href="#balanceof">balanceOf</a></h3>
<p><em>See <a href="src/circles/ERC1155.sol//src/lift/ERC20DiscountedBalances.sol/contract.ERC20DiscountedBalances.html#balanceof">IERC1155-balanceOf</a>.</em></p>
<pre><code class="language-solidity">function balanceOf(address _account, uint256 _id) public view returns (uint256);
</code></pre>
<h3 id="balanceofbatch"><a class="header" href="#balanceofbatch">balanceOfBatch</a></h3>
<p>*See <a href="src/circles/ERC1155.sol//lib/forge-std/src/interfaces/IERC1155.sol/interface.IERC1155.html#balanceofbatch">IERC1155-balanceOfBatch</a>.
Requirements:</p>
<ul>
<li><code>accounts</code> and <code>ids</code> must have the same length.*</li>
</ul>
<pre><code class="language-solidity">function balanceOfBatch(address[] memory _accounts, uint256[] memory _ids) public view returns (uint256[] memory);
</code></pre>
<h3 id="setapprovalforall"><a class="header" href="#setapprovalforall">setApprovalForAll</a></h3>
<p><em>See <a href="src/circles/ERC1155.sol//lib/forge-std/src/interfaces/IERC1155.sol/interface.IERC1155.html#setapprovalforall">IERC1155-setApprovalForAll</a>.</em></p>
<pre><code class="language-solidity">function setApprovalForAll(address _operator, bool _approved) public;
</code></pre>
<h3 id="isapprovedforall"><a class="header" href="#isapprovedforall">isApprovedForAll</a></h3>
<p><em>See <a href="src/circles/ERC1155.sol//lib/forge-std/src/interfaces/IERC1155.sol/interface.IERC1155.html#isapprovedforall">IERC1155-isApprovedForAll</a>.</em></p>
<pre><code class="language-solidity">function isApprovedForAll(address _account, address _operator) public view returns (bool);
</code></pre>
<h3 id="safetransferfrom"><a class="header" href="#safetransferfrom">safeTransferFrom</a></h3>
<p><em>See <a href="src/circles/ERC1155.sol//lib/forge-std/src/interfaces/IERC1155.sol/interface.IERC1155.html#safetransferfrom">IERC1155-safeTransferFrom</a>.</em></p>
<pre><code class="language-solidity">function safeTransferFrom(address _from, address _to, uint256 _id, uint256 _value, bytes memory _data) public;
</code></pre>
<h3 id="safebatchtransferfrom"><a class="header" href="#safebatchtransferfrom">safeBatchTransferFrom</a></h3>
<p><em>See <a href="src/circles/ERC1155.sol//lib/forge-std/src/interfaces/IERC1155.sol/interface.IERC1155.html#safebatchtransferfrom">IERC1155-safeBatchTransferFrom</a>.</em></p>
<pre><code class="language-solidity">function safeBatchTransferFrom(
    address _from,
    address _to,
    uint256[] memory _ids,
    uint256[] memory _values,
    bytes memory _data
) public virtual;
</code></pre>
<h3 id="_update"><a class="header" href="#_update">_update</a></h3>
<p>*Transfers a <code>value</code> amount of tokens of type <code>id</code> from <code>from</code> to <code>to</code>. Will mint (or burn) if <code>from</code>
(or <code>to</code>) is the zero address.
Emits a {TransferSingle} event if the arrays contain one element, and {TransferBatch} otherwise.
Requirements:</p>
<ul>
<li>If <code>to</code> refers to a smart contract, it must implement either {IERC1155Receiver-onERC1155Received}
or {IERC1155Receiver-onERC1155BatchReceived} and return the acceptance magic value.</li>
<li><code>ids</code> and <code>values</code> must have the same length.
NOTE: The ERC-1155 acceptance check is not performed in this function. See {_updateWithAcceptanceCheck} instead.*</li>
</ul>
<pre><code class="language-solidity">function _update(address from, address to, uint256[] memory ids, uint256[] memory values) internal virtual;
</code></pre>
<h3 id="_updatewithacceptancecheck"><a class="header" href="#_updatewithacceptancecheck">_updateWithAcceptanceCheck</a></h3>
<p><em>Version of <a href="src/circles/ERC1155.sol//src/circles/ERC1155.sol/abstract.ERC1155.html#_update">_update</a> that performs the token acceptance check by calling
{IERC1155Receiver-onERC1155Received} or {IERC1155Receiver-onERC1155BatchReceived} on the receiver address if it
contains code (eg. is a smart contract at the moment of execution).
IMPORTANT: Overriding this function is discouraged because it poses a reentrancy risk from the receiver. So any
update to the contract state after this function would break the check-effect-interaction pattern. Consider
overriding {_update} instead.</em></p>
<pre><code class="language-solidity">function _updateWithAcceptanceCheck(
    address from,
    address to,
    uint256[] memory ids,
    uint256[] memory values,
    bytes memory data
) internal virtual;
</code></pre>
<h3 id="_acceptancecheck"><a class="header" href="#_acceptancecheck">_acceptanceCheck</a></h3>
<p><em>do the ERC1155 token acceptance check to the receiver</em></p>
<pre><code class="language-solidity">function _acceptanceCheck(
    address _from,
    address _to,
    uint256[] memory _ids,
    uint256[] memory _values,
    bytes memory _data
) internal;
</code></pre>
<h3 id="_safetransferfrom"><a class="header" href="#_safetransferfrom">_safeTransferFrom</a></h3>
<p>*Transfers a <code>value</code> tokens of token type <code>id</code> from <code>from</code> to <code>to</code>.
Emits a {TransferSingle} event.
Requirements:</p>
<ul>
<li><code>to</code> cannot be the zero address.</li>
<li><code>from</code> must have a balance of tokens of type <code>id</code> of at least <code>value</code> amount.</li>
<li>If <code>to</code> refers to a smart contract, it must implement {IERC1155Receiver-onERC1155Received} and return the
acceptance magic value.*</li>
</ul>
<pre><code class="language-solidity">function _safeTransferFrom(address from, address to, uint256 id, uint256 value, bytes memory data) internal;
</code></pre>
<h3 id="_safebatchtransferfrom"><a class="header" href="#_safebatchtransferfrom">_safeBatchTransferFrom</a></h3>
<p>*xref:ROOT:erc1155.adoc#batch-operations[Batched] version of <a href="src/circles/ERC1155.sol//src/circles/ERC1155.sol/abstract.ERC1155.html#_safetransferfrom">_safeTransferFrom</a>.
Emits a {TransferBatch} event.
Requirements:</p>
<ul>
<li>If <code>to</code> refers to a smart contract, it must implement {IERC1155Receiver-onERC1155BatchReceived} and return the
acceptance magic value.</li>
<li><code>ids</code> and <code>values</code> must have the same length.*</li>
</ul>
<pre><code class="language-solidity">function _safeBatchTransferFrom(
    address from,
    address to,
    uint256[] memory ids,
    uint256[] memory values,
    bytes memory data
) internal;
</code></pre>
<h3 id="_seturi"><a class="header" href="#_seturi">_setURI</a></h3>
<p><em>Sets a new URI for all token types, by relying on the token type ID
substitution mechanism
https://eips.ethereum.org/EIPS/eip-1155#metadata[defined in the EIP].
By this mechanism, any occurrence of the <code>\{id\}</code> substring in either the
URI or any of the values in the JSON file at said URI will be replaced by
clients with the token type ID.
For example, the <code>https://token-cdn-domain/\{id\}.json</code> URI would be
interpreted by clients as
<code>https://token-cdn-domain/000000000000000000000000000000000000000000000000000000000004cce0.json</code>
for token type ID 0x4cce0.
See <a href="src/circles/ERC1155.sol//src/circles/ERC1155.sol/abstract.ERC1155.html#uri">uri</a>.
Because these URIs cannot be meaningfully represented by the {URI} event,
this function emits no events.</em></p>
<pre><code class="language-solidity">function _setURI(string memory _newuri) internal virtual;
</code></pre>
<h3 id="_mint"><a class="header" href="#_mint">_mint</a></h3>
<p>*Creates a <code>value</code> amount of tokens of type <code>id</code>, and assigns them to <code>to</code>.
Emits a {TransferSingle} event.
Requirements:</p>
<ul>
<li><code>to</code> cannot be the zero address.</li>
<li>If <code>to</code> refers to a smart contract, it must implement {IERC1155Receiver-onERC1155Received} and return the
acceptance magic value.*</li>
</ul>
<pre><code class="language-solidity">function _mint(address to, uint256 id, uint256 value, bytes memory data) internal;
</code></pre>
<h3 id="_burn"><a class="header" href="#_burn">_burn</a></h3>
<p>*xref:ROOT:erc1155.adoc#batch-operations[Batched] version of <a href="src/circles/ERC1155.sol//src/circles/ERC1155.sol/abstract.ERC1155.html#_mint">_mint</a>.
Emits a {TransferBatch} event.
Requirements:</p>
<ul>
<li><code>ids</code> and <code>values</code> must have the same length.</li>
<li><code>to</code> cannot be the zero address.</li>
<li>If <code>to</code> refers to a smart contract, it must implement {IERC1155Receiver-onERC1155BatchReceived} and return the
acceptance magic value.*</li>
</ul>
<p>*Destroys a <code>value</code> amount of tokens of type <code>id</code> from <code>from</code>
Emits a {TransferSingle} event.
Requirements:</p>
<ul>
<li><code>from</code> cannot be the zero address.</li>
<li><code>from</code> must have at least <code>value</code> amount of tokens of type <code>id</code>.*</li>
</ul>
<pre><code class="language-solidity">function _burn(address from, uint256 id, uint256 value) internal;
</code></pre>
<h3 id="_setapprovalforall"><a class="header" href="#_setapprovalforall">_setApprovalForAll</a></h3>
<p>*xref:ROOT:erc1155.adoc#batch-operations[Batched] version of <a href="src/circles/ERC1155.sol//src/circles/ERC1155.sol/abstract.ERC1155.html#_burn">_burn</a>.
Emits a {TransferBatch} event.
Requirements:</p>
<ul>
<li><code>from</code> cannot be the zero address.</li>
<li><code>from</code> must have at least <code>value</code> amount of tokens of type <code>id</code>.</li>
<li><code>ids</code> and <code>values</code> must have the same length.
//*</li>
</ul>
<p>*Approve <code>operator</code> to operate on all of <code>owner</code> tokens
Emits an {ApprovalForAll} event.
Requirements:</p>
<ul>
<li><code>operator</code> cannot be the zero address.*</li>
</ul>
<pre><code class="language-solidity">function _setApprovalForAll(address owner, address operator, bool approved) internal virtual;
</code></pre>
<h3 id="_assingletonarrays"><a class="header" href="#_assingletonarrays">_asSingletonArrays</a></h3>
<p><em>Creates an array in memory with only one value for each of the elements provided.</em></p>
<pre><code class="language-solidity">function _asSingletonArrays(uint256 element1, uint256 element2)
    internal
    pure
    returns (uint256[] memory array1, uint256[] memory array2);
</code></pre>
<h3 id="_dosafetransferacceptancecheck"><a class="header" href="#_dosafetransferacceptancecheck">_doSafeTransferAcceptanceCheck</a></h3>
<p><em>Performs an acceptance check by calling <a href="src/circles/ERC1155.sol//src/treasury/StandardTreasury.sol/contract.StandardTreasury.html#onerc1155received">IERC1155-onERC1155Received</a> on the <code>to</code> address
if it contains code at the moment of execution.</em></p>
<pre><code class="language-solidity">function _doSafeTransferAcceptanceCheck(
    address operator,
    address from,
    address to,
    uint256 id,
    uint256 value,
    bytes memory data
) private;
</code></pre>
<h3 id="_dosafebatchtransferacceptancecheck"><a class="header" href="#_dosafebatchtransferacceptancecheck">_doSafeBatchTransferAcceptanceCheck</a></h3>
<p><em>Performs a batch acceptance check by calling <a href="src/circles/ERC1155.sol//src/treasury/StandardTreasury.sol/contract.StandardTreasury.html#onerc1155batchreceived">IERC1155-onERC1155BatchReceived</a> on the <code>to</code> address
if it contains code at the moment of execution.</em></p>
<pre><code class="language-solidity">function _doSafeBatchTransferAcceptanceCheck(
    address operator,
    address from,
    address to,
    uint256[] memory ids,
    uint256[] memory values,
    bytes memory data
) private;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="icircles"><a class="header" href="#icircles">ICircles</a></h1>
<p><a href="https://github.com/aboutcircles/circles-contracts-v2/blob/9fbbffb44eda7934ea8adf9354e5f09f6b15b8b2/src/circles/ICircles.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="src/circles/ICircles.sol//src/circles/IDemurrage.sol/interface.IDemurrage.html">IDemurrage</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="idemurrage"><a class="header" href="#idemurrage">IDemurrage</a></h1>
<p><a href="https://github.com/aboutcircles/circles-contracts-v2/blob/9fbbffb44eda7934ea8adf9354e5f09f6b15b8b2/src/circles/IDemurrage.sol">Git Source</a></p>
<h2 id="functions-4"><a class="header" href="#functions-4">Functions</a></h2>
<h3 id="inflationdayzero-1"><a class="header" href="#inflationdayzero-1">inflationDayZero</a></h3>
<pre><code class="language-solidity">function inflationDayZero() external view returns (uint256);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents-1"><a class="header" href="#contents-1">Contents</a></h1>
<ul>
<li><a href="src/errors/Errors.sol/interface.IHubErrors.html">IHubErrors</a></li>
<li><a href="src/errors/Errors.sol/interface.ICirclesDemurrageErrors.html">ICirclesDemurrageErrors</a></li>
<li><a href="src/errors/Errors.sol/interface.ICirclesErrors.html">ICirclesErrors</a></li>
<li><a href="src/errors/Errors.sol/interface.IStandardTreasuryErrors.html">IStandardTreasuryErrors</a></li>
<li><a href="src/errors/Errors.sol/interface.INameRegistryErrors.html">INameRegistryErrors</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ihuberrors"><a class="header" href="#ihuberrors">IHubErrors</a></h1>
<p><a href="https://github.com/aboutcircles/circles-contracts-v2/blob/9fbbffb44eda7934ea8adf9354e5f09f6b15b8b2/src/errors/Errors.sol">Git Source</a></p>
<h2 id="errors"><a class="header" href="#errors">Errors</a></h2>
<h3 id="circleshubonlyduringbootstrap"><a class="header" href="#circleshubonlyduringbootstrap">CirclesHubOnlyDuringBootstrap</a></h3>
<pre><code class="language-solidity">error CirclesHubOnlyDuringBootstrap(uint8 code);
</code></pre>
<h3 id="circleshubregisteravatarv1mustbestopped"><a class="header" href="#circleshubregisteravatarv1mustbestopped">CirclesHubRegisterAvatarV1MustBeStopped</a></h3>
<pre><code class="language-solidity">error CirclesHubRegisterAvatarV1MustBeStopped(address avatar, uint8 code);
</code></pre>
<h3 id="circleshubavataralreadyregistered"><a class="header" href="#circleshubavataralreadyregistered">CirclesHubAvatarAlreadyRegistered</a></h3>
<pre><code class="language-solidity">error CirclesHubAvatarAlreadyRegistered(address avatar, uint8 code);
</code></pre>
<h3 id="circleshubmustbehuman"><a class="header" href="#circleshubmustbehuman">CirclesHubMustBeHuman</a></h3>
<pre><code class="language-solidity">error CirclesHubMustBeHuman(address avatar, uint8 code);
</code></pre>
<h3 id="circleshubgroupisnotregistered"><a class="header" href="#circleshubgroupisnotregistered">CirclesHubGroupIsNotRegistered</a></h3>
<pre><code class="language-solidity">error CirclesHubGroupIsNotRegistered(address group, uint8 code);
</code></pre>
<h3 id="circleshubinvalidtrustreceiver"><a class="header" href="#circleshubinvalidtrustreceiver">CirclesHubInvalidTrustReceiver</a></h3>
<pre><code class="language-solidity">error CirclesHubInvalidTrustReceiver(address trustReceiver, uint8 code);
</code></pre>
<h3 id="circleshubgroupmintpolicyrejectedmint"><a class="header" href="#circleshubgroupmintpolicyrejectedmint">CirclesHubGroupMintPolicyRejectedMint</a></h3>
<pre><code class="language-solidity">error CirclesHubGroupMintPolicyRejectedMint(
    address minter, address group, uint256[] collateral, uint256[] amounts, bytes data, uint8 code
);
</code></pre>
<h3 id="circleshubgroupmintpolicyrejectedburn"><a class="header" href="#circleshubgroupmintpolicyrejectedburn">CirclesHubGroupMintPolicyRejectedBurn</a></h3>
<pre><code class="language-solidity">error CirclesHubGroupMintPolicyRejectedBurn(address burner, address group, uint256 amount, bytes data, uint8 code);
</code></pre>
<h3 id="circleshuboperatornotapprovedforsource"><a class="header" href="#circleshuboperatornotapprovedforsource">CirclesHubOperatorNotApprovedForSource</a></h3>
<pre><code class="language-solidity">error CirclesHubOperatorNotApprovedForSource(address operator, address source, uint16 streamId, uint8 code);
</code></pre>
<h3 id="circleshubflowedgeisnotpermitted"><a class="header" href="#circleshubflowedgeisnotpermitted">CirclesHubFlowEdgeIsNotPermitted</a></h3>
<pre><code class="language-solidity">error CirclesHubFlowEdgeIsNotPermitted(address receiver, uint256 circlesId, uint8 code);
</code></pre>
<h3 id="circleshubonclosedpathonlypersonalcirclescanreturntoavatar"><a class="header" href="#circleshubonclosedpathonlypersonalcirclescanreturntoavatar">CirclesHubOnClosedPathOnlyPersonalCirclesCanReturnToAvatar</a></h3>
<pre><code class="language-solidity">error CirclesHubOnClosedPathOnlyPersonalCirclesCanReturnToAvatar(address failedReceiver, uint256 circlesId);
</code></pre>
<h3 id="circleshubflowverticesmustbesorted"><a class="header" href="#circleshubflowverticesmustbesorted">CirclesHubFlowVerticesMustBeSorted</a></h3>
<pre><code class="language-solidity">error CirclesHubFlowVerticesMustBeSorted();
</code></pre>
<h3 id="circleshubflowedgestreammismatch"><a class="header" href="#circleshubflowedgestreammismatch">CirclesHubFlowEdgeStreamMismatch</a></h3>
<pre><code class="language-solidity">error CirclesHubFlowEdgeStreamMismatch(uint16 flowEdgeId, uint16 streamId, uint8 code);
</code></pre>
<h3 id="circleshubstreammismatch"><a class="header" href="#circleshubstreammismatch">CirclesHubStreamMismatch</a></h3>
<pre><code class="language-solidity">error CirclesHubStreamMismatch(uint16 streamId, uint8 code);
</code></pre>
<h3 id="circleshubnettedflowmismatch"><a class="header" href="#circleshubnettedflowmismatch">CirclesHubNettedFlowMismatch</a></h3>
<pre><code class="language-solidity">error CirclesHubNettedFlowMismatch(uint16 vertexPosition, int256 matrixNettedFlow, int256 streamNettedFlow);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="icirclesdemurrageerrors"><a class="header" href="#icirclesdemurrageerrors">ICirclesDemurrageErrors</a></h1>
<p><a href="https://github.com/aboutcircles/circles-contracts-v2/blob/9fbbffb44eda7934ea8adf9354e5f09f6b15b8b2/src/errors/Errors.sol">Git Source</a></p>
<h2 id="errors-1"><a class="header" href="#errors-1">Errors</a></h2>
<h3 id="circleserc1155mintblocked"><a class="header" href="#circleserc1155mintblocked">CirclesERC1155MintBlocked</a></h3>
<pre><code class="language-solidity">error CirclesERC1155MintBlocked(address human, address mintV1Status);
</code></pre>
<h3 id="circlesdemurrageamountexceedsmaxuint190"><a class="header" href="#circlesdemurrageamountexceedsmaxuint190">CirclesDemurrageAmountExceedsMaxUint190</a></h3>
<pre><code class="language-solidity">error CirclesDemurrageAmountExceedsMaxUint190(address account, uint256 circlesId, uint256 amount, uint8 code);
</code></pre>
<h3 id="circlesdemurragedaybeforelastupdatedday"><a class="header" href="#circlesdemurragedaybeforelastupdatedday">CirclesDemurrageDayBeforeLastUpdatedDay</a></h3>
<pre><code class="language-solidity">error CirclesDemurrageDayBeforeLastUpdatedDay(
    address account, uint256 circlesId, uint64 day, uint64 lastUpdatedDay, uint8 code
);
</code></pre>
<h3 id="circleserc1155cannotreceivebatch"><a class="header" href="#circleserc1155cannotreceivebatch">CirclesERC1155CannotReceiveBatch</a></h3>
<pre><code class="language-solidity">error CirclesERC1155CannotReceiveBatch(uint8 code);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="icircleserrors"><a class="header" href="#icircleserrors">ICirclesErrors</a></h1>
<p><a href="https://github.com/aboutcircles/circles-contracts-v2/blob/9fbbffb44eda7934ea8adf9354e5f09f6b15b8b2/src/errors/Errors.sol">Git Source</a></p>
<h2 id="errors-2"><a class="header" href="#errors-2">Errors</a></h2>
<h3 id="circlesavatarmustberegistered"><a class="header" href="#circlesavatarmustberegistered">CirclesAvatarMustBeRegistered</a></h3>
<pre><code class="language-solidity">error CirclesAvatarMustBeRegistered(address avatar, uint8 code);
</code></pre>
<h3 id="circlesaddresscannotbezero"><a class="header" href="#circlesaddresscannotbezero">CirclesAddressCannotBeZero</a></h3>
<pre><code class="language-solidity">error CirclesAddressCannotBeZero(uint8 code);
</code></pre>
<h3 id="circlesinvalidfunctioncaller"><a class="header" href="#circlesinvalidfunctioncaller">CirclesInvalidFunctionCaller</a></h3>
<pre><code class="language-solidity">error CirclesInvalidFunctionCaller(address caller, address expectedCaller, uint8 code);
</code></pre>
<h3 id="circlesinvalidcirclesid"><a class="header" href="#circlesinvalidcirclesid">CirclesInvalidCirclesId</a></h3>
<pre><code class="language-solidity">error CirclesInvalidCirclesId(uint256 id, uint8 code);
</code></pre>
<h3 id="circlesinvalidstring"><a class="header" href="#circlesinvalidstring">CirclesInvalidString</a></h3>
<pre><code class="language-solidity">error CirclesInvalidString(string str, uint8 code);
</code></pre>
<h3 id="circlesinvalidparameter"><a class="header" href="#circlesinvalidparameter">CirclesInvalidParameter</a></h3>
<pre><code class="language-solidity">error CirclesInvalidParameter(uint256 parameter, uint8 code);
</code></pre>
<h3 id="circlesamountoverflow"><a class="header" href="#circlesamountoverflow">CirclesAmountOverflow</a></h3>
<pre><code class="language-solidity">error CirclesAmountOverflow(uint256 amount, uint8 code);
</code></pre>
<h3 id="circlesarrayslengthmismatch"><a class="header" href="#circlesarrayslengthmismatch">CirclesArraysLengthMismatch</a></h3>
<pre><code class="language-solidity">error CirclesArraysLengthMismatch(uint256 lengthArray1, uint256 lengthArray2, uint8 code);
</code></pre>
<h3 id="circlesarraymustnotbeempty"><a class="header" href="#circlesarraymustnotbeempty">CirclesArrayMustNotBeEmpty</a></h3>
<pre><code class="language-solidity">error CirclesArrayMustNotBeEmpty(uint8 code);
</code></pre>
<h3 id="circlesamountmustnotbezero"><a class="header" href="#circlesamountmustnotbezero">CirclesAmountMustNotBeZero</a></h3>
<pre><code class="language-solidity">error CirclesAmountMustNotBeZero(uint8 code);
</code></pre>
<h3 id="circlesproxyalreadyinitialized"><a class="header" href="#circlesproxyalreadyinitialized">CirclesProxyAlreadyInitialized</a></h3>
<pre><code class="language-solidity">error CirclesProxyAlreadyInitialized();
</code></pre>
<h3 id="circleslogicassertion"><a class="header" href="#circleslogicassertion">CirclesLogicAssertion</a></h3>
<pre><code class="language-solidity">error CirclesLogicAssertion(uint8 code);
</code></pre>
<h3 id="circlesidmustbederivedfromaddress"><a class="header" href="#circlesidmustbederivedfromaddress">CirclesIdMustBeDerivedFromAddress</a></h3>
<pre><code class="language-solidity">error CirclesIdMustBeDerivedFromAddress(uint256 providedId, uint8 code);
</code></pre>
<h3 id="circlesreentrancyguard"><a class="header" href="#circlesreentrancyguard">CirclesReentrancyGuard</a></h3>
<pre><code class="language-solidity">error CirclesReentrancyGuard(uint8 code);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="istandardtreasuryerrors"><a class="header" href="#istandardtreasuryerrors">IStandardTreasuryErrors</a></h1>
<p><a href="https://github.com/aboutcircles/circles-contracts-v2/blob/9fbbffb44eda7934ea8adf9354e5f09f6b15b8b2/src/errors/Errors.sol">Git Source</a></p>
<h2 id="errors-3"><a class="header" href="#errors-3">Errors</a></h2>
<h3 id="circlesstandardtreasurygrouphasnovault"><a class="header" href="#circlesstandardtreasurygrouphasnovault">CirclesStandardTreasuryGroupHasNoVault</a></h3>
<pre><code class="language-solidity">error CirclesStandardTreasuryGroupHasNoVault(address group);
</code></pre>
<h3 id="circlesstandardtreasuryredemptioncollateralmismatch"><a class="header" href="#circlesstandardtreasuryredemptioncollateralmismatch">CirclesStandardTreasuryRedemptionCollateralMismatch</a></h3>
<pre><code class="language-solidity">error CirclesStandardTreasuryRedemptionCollateralMismatch(
    uint256 circlesId, uint256[] redemptionIds, uint256[] redemptionValues, uint256[] burnIds, uint256[] burnValues
);
</code></pre>
<h3 id="circlesstandardtreasuryinvalidmetadatatype"><a class="header" href="#circlesstandardtreasuryinvalidmetadatatype">CirclesStandardTreasuryInvalidMetadataType</a></h3>
<pre><code class="language-solidity">error CirclesStandardTreasuryInvalidMetadataType(bytes32 metadataType, uint8 code);
</code></pre>
<h3 id="circlesstandardtreasuryinvalidmetadata"><a class="header" href="#circlesstandardtreasuryinvalidmetadata">CirclesStandardTreasuryInvalidMetadata</a></h3>
<pre><code class="language-solidity">error CirclesStandardTreasuryInvalidMetadata(bytes metadata, uint8 code);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="inameregistryerrors"><a class="header" href="#inameregistryerrors">INameRegistryErrors</a></h1>
<p><a href="https://github.com/aboutcircles/circles-contracts-v2/blob/9fbbffb44eda7934ea8adf9354e5f09f6b15b8b2/src/errors/Errors.sol">Git Source</a></p>
<h2 id="errors-4"><a class="header" href="#errors-4">Errors</a></h2>
<h3 id="circlesnamesinvalidname"><a class="header" href="#circlesnamesinvalidname">CirclesNamesInvalidName</a></h3>
<pre><code class="language-solidity">error CirclesNamesInvalidName(address avatar, string name, uint8 code);
</code></pre>
<h3 id="circlesnamesshortnamealreadyassigned"><a class="header" href="#circlesnamesshortnamealreadyassigned">CirclesNamesShortNameAlreadyAssigned</a></h3>
<pre><code class="language-solidity">error CirclesNamesShortNameAlreadyAssigned(address avatar, uint72 shortName, uint8 code);
</code></pre>
<h3 id="circlesnamesshortnamewithnoncetaken"><a class="header" href="#circlesnamesshortnamewithnoncetaken">CirclesNamesShortNameWithNonceTaken</a></h3>
<pre><code class="language-solidity">error CirclesNamesShortNameWithNonceTaken(address avatar, uint256 nonce, uint72 shortName, address takenByAvatar);
</code></pre>
<h3 id="circlesnamesavataralreadyhascustomnameorsymbol"><a class="header" href="#circlesnamesavataralreadyhascustomnameorsymbol">CirclesNamesAvatarAlreadyHasCustomNameOrSymbol</a></h3>
<pre><code class="language-solidity">error CirclesNamesAvatarAlreadyHasCustomNameOrSymbol(address avatar, string nameOrSymbol, uint8 code);
</code></pre>
<h3 id="circlesnamesorganizationhasnosymbol"><a class="header" href="#circlesnamesorganizationhasnosymbol">CirclesNamesOrganizationHasNoSymbol</a></h3>
<pre><code class="language-solidity">error CirclesNamesOrganizationHasNoSymbol(address organization, uint8 code);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents-2"><a class="header" href="#contents-2">Contents</a></h1>
<ul>
<li><a href="src/groups/BaseMintPolicy.sol/contract.MintPolicy.html">MintPolicy</a></li>
<li><a href="src/groups/Definitions.sol/contract.BaseMintPolicyDefinitions.html">BaseMintPolicyDefinitions</a></li>
<li><a href="src/groups/IMintPolicy.sol/interface.IMintPolicy.html">IMintPolicy</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="mintpolicy"><a class="header" href="#mintpolicy">MintPolicy</a></h1>
<p><a href="https://github.com/aboutcircles/circles-contracts-v2/blob/9fbbffb44eda7934ea8adf9354e5f09f6b15b8b2/src/groups/BaseMintPolicy.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="src/groups/BaseMintPolicy.sol//src/groups/IMintPolicy.sol/interface.IMintPolicy.html">IMintPolicy</a></p>
<h2 id="functions-5"><a class="header" href="#functions-5">Functions</a></h2>
<h3 id="beforemintpolicy"><a class="header" href="#beforemintpolicy">beforeMintPolicy</a></h3>
<p>Simple mint policy that always returns true</p>
<pre><code class="language-solidity">function beforeMintPolicy(address, address, uint256[] calldata, uint256[] calldata, bytes calldata)
    external
    virtual
    override
    returns (bool);
</code></pre>
<h3 id="beforeburnpolicy"><a class="header" href="#beforeburnpolicy">beforeBurnPolicy</a></h3>
<p>Simple burn policy that always returns true</p>
<pre><code class="language-solidity">function beforeBurnPolicy(address, address, uint256, bytes calldata) external virtual override returns (bool);
</code></pre>
<h3 id="beforeredeempolicy"><a class="header" href="#beforeredeempolicy">beforeRedeemPolicy</a></h3>
<p>Simple redeem policy that returns the redemption ids and values as requested in the data</p>
<pre><code class="language-solidity">function beforeRedeemPolicy(address, address, address, uint256, bytes calldata _data)
    external
    virtual
    override
    returns (uint256[] memory _ids, uint256[] memory _values, uint256[] memory _burnIds, uint256[] memory _burnValues);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>address</code></td><td></td></tr>
<tr><td><code>&lt;none&gt;</code></td><td><code>address</code></td><td></td></tr>
<tr><td><code>&lt;none&gt;</code></td><td><code>address</code></td><td></td></tr>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td></td></tr>
<tr><td><code>_data</code></td><td><code>bytes</code></td><td>Optional data bytes passed to redeem policy</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="basemintpolicydefinitions"><a class="header" href="#basemintpolicydefinitions">BaseMintPolicyDefinitions</a></h1>
<p><a href="https://github.com/aboutcircles/circles-contracts-v2/blob/9fbbffb44eda7934ea8adf9354e5f09f6b15b8b2/src/groups/Definitions.sol">Git Source</a></p>
<h2 id="structs-2"><a class="header" href="#structs-2">Structs</a></h2>
<h3 id="baseredemptionpolicy"><a class="header" href="#baseredemptionpolicy">BaseRedemptionPolicy</a></h3>
<p>Base redemption policy to user specify desired collateral to redeem</p>
<pre><code class="language-solidity">struct BaseRedemptionPolicy {
    uint256[] redemptionIds;
    uint256[] redemptionValues;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="imintpolicy"><a class="header" href="#imintpolicy">IMintPolicy</a></h1>
<p><a href="https://github.com/aboutcircles/circles-contracts-v2/blob/9fbbffb44eda7934ea8adf9354e5f09f6b15b8b2/src/groups/IMintPolicy.sol">Git Source</a></p>
<h2 id="functions-6"><a class="header" href="#functions-6">Functions</a></h2>
<h3 id="beforemintpolicy-1"><a class="header" href="#beforemintpolicy-1">beforeMintPolicy</a></h3>
<pre><code class="language-solidity">function beforeMintPolicy(
    address minter,
    address group,
    uint256[] calldata collateral,
    uint256[] calldata amounts,
    bytes calldata data
) external returns (bool);
</code></pre>
<h3 id="beforeredeempolicy-1"><a class="header" href="#beforeredeempolicy-1">beforeRedeemPolicy</a></h3>
<pre><code class="language-solidity">function beforeRedeemPolicy(address operator, address redeemer, address group, uint256 value, bytes calldata data)
    external
    returns (
        uint256[] memory redemptionIds,
        uint256[] memory redemptionValues,
        uint256[] memory burnIds,
        uint256[] memory burnValues
    );
</code></pre>
<h3 id="beforeburnpolicy-1"><a class="header" href="#beforeburnpolicy-1">beforeBurnPolicy</a></h3>
<pre><code class="language-solidity">function beforeBurnPolicy(address burner, address group, uint256 value, bytes calldata data) external returns (bool);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents-3"><a class="header" href="#contents-3">Contents</a></h1>
<ul>
<li><a href="src/hub/Hub.sol/contract.Hub.html">Hub</a></li>
<li><a href="src/hub/IHub.sol/interface.IHubV2.html">IHubV2</a></li>
<li><a href="src/hub/TypeDefinitions.sol/contract.TypeDefinitions.html">TypeDefinitions</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="hub"><a class="header" href="#hub">Hub</a></h1>
<p><a href="https://github.com/aboutcircles/circles-contracts-v2/blob/9fbbffb44eda7934ea8adf9354e5f09f6b15b8b2/src/hub/Hub.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="src/hub/Hub.sol//src/circles/Circles.sol/contract.Circles.html">Circles</a>, <a href="src/hub/Hub.sol//src/hub/TypeDefinitions.sol/contract.TypeDefinitions.html">TypeDefinitions</a>, <a href="src/hub/Hub.sol//src/errors/Errors.sol/interface.IHubErrors.html">IHubErrors</a></p>
<p>The Hub contract is the main contract for the Circles protocol.
It adopts the ERC1155 standard for multi-token contracts and governs
the personal and group Circles of people, organizations and groups.
Circle balances are demurraged in the Hub contract.
It registers the trust relations between people and groups and allows
to transfer Circles to be path fungible along trust relations.
It further allows to wrap any token into an inflationary or demurraged
ERC20 Circles contract.</p>
<h2 id="state-variables-4"><a class="header" href="#state-variables-4">State Variables</a></h2>
<h3 id="welcome_bonus"><a class="header" href="#welcome_bonus">WELCOME_BONUS</a></h3>
<p><em>Welcome bonus for new avatars invited to Circles. Set to 50 Circles.</em></p>
<pre><code class="language-solidity">uint256 private constant WELCOME_BONUS = 50 * EXA;
</code></pre>
<h3 id="invitation_cost"><a class="header" href="#invitation_cost">INVITATION_COST</a></h3>
<p><em>The cost of an invitation for a new avatar, paid in personal Circles burnt, set to 100 Circles.</em></p>
<pre><code class="language-solidity">uint256 private constant INVITATION_COST = 2 * WELCOME_BONUS;
</code></pre>
<h3 id="sentinel"><a class="header" href="#sentinel">SENTINEL</a></h3>
<p><em>The address used as the first element of the linked list of avatars.</em></p>
<pre><code class="language-solidity">address private constant SENTINEL = address(0x1);
</code></pre>
<h3 id="advanced_flag_optout_consentedflow"><a class="header" href="#advanced_flag_optout_consentedflow">ADVANCED_FLAG_OPTOUT_CONSENTEDFLOW</a></h3>
<pre><code class="language-solidity">bytes32 private constant ADVANCED_FLAG_OPTOUT_CONSENTEDFLOW = bytes32(uint256(1));
</code></pre>
<h3 id="hubv1"><a class="header" href="#hubv1">hubV1</a></h3>
<p>The Hub v1 contract address.</p>
<pre><code class="language-solidity">IHubV1 internal immutable hubV1;
</code></pre>
<h3 id="nameregistry"><a class="header" href="#nameregistry">nameRegistry</a></h3>
<p>The name registry contract address.</p>
<pre><code class="language-solidity">INameRegistry internal nameRegistry;
</code></pre>
<h3 id="migration"><a class="header" href="#migration">migration</a></h3>
<p>The address of the migration contract for v1 Circles.</p>
<pre><code class="language-solidity">address internal migration;
</code></pre>
<h3 id="lifterc20"><a class="header" href="#lifterc20">liftERC20</a></h3>
<p>The address of the Lift ERC20 contract.</p>
<pre><code class="language-solidity">IERC20Lift internal liftERC20;
</code></pre>
<h3 id="invitationonlytime"><a class="header" href="#invitationonlytime">invitationOnlyTime</a></h3>
<p>The timestamp of the start of the invitation-only period.</p>
<p><em>This is used to determine the start of the invitation-only period.
Prior to this time v1 avatars can register without an invitation, and
new avatars can be invited by registered avatars. After this time
only registered avatars can invite new avatars.</em></p>
<pre><code class="language-solidity">uint256 internal immutable invitationOnlyTime;
</code></pre>
<h3 id="standardtreasury"><a class="header" href="#standardtreasury">standardTreasury</a></h3>
<p>The standard treasury contract address used when
registering a (non-custom) group.</p>
<pre><code class="language-solidity">address internal standardTreasury;
</code></pre>
<h3 id="avatars"><a class="header" href="#avatars">avatars</a></h3>
<p>The mapping of registered avatar addresses to the next avatar address,
stored as a linked list.</p>
<p><em>This is used to store the linked list of registered avatars.</em></p>
<pre><code class="language-solidity">mapping(address =&gt; address) public avatars;
</code></pre>
<h3 id="mintpolicies"><a class="header" href="#mintpolicies">mintPolicies</a></h3>
<p>The mapping of group avatar addresses to the mint policy contract address.</p>
<pre><code class="language-solidity">mapping(address =&gt; address) public mintPolicies;
</code></pre>
<h3 id="treasuries"><a class="header" href="#treasuries">treasuries</a></h3>
<p>The mapping of group avatar addresses to the treasury contract address.</p>
<pre><code class="language-solidity">mapping(address =&gt; address) public treasuries;
</code></pre>
<h3 id="advancedusageflags"><a class="header" href="#advancedusageflags">advancedUsageFlags</a></h3>
<p>By default the advanced usage flags should remain set to zero.
Only for advanced purposes people can consider enabling flags.</p>
<pre><code class="language-solidity">mapping(address =&gt; bytes32) public advancedUsageFlags;
</code></pre>
<h3 id="trustmarkers"><a class="header" href="#trustmarkers">trustMarkers</a></h3>
<p>The iterable mapping of directional trust relations between avatars and
their expiry times.</p>
<pre><code class="language-solidity">mapping(address =&gt; mapping(address =&gt; TrustMarker)) public trustMarkers;
</code></pre>
<h2 id="functions-7"><a class="header" href="#functions-7">Functions</a></h2>
<h3 id="onlyduringbootstrap"><a class="header" href="#onlyduringbootstrap">onlyDuringBootstrap</a></h3>
<p>Modifier to check if the current time is during the bootstrap period.</p>
<pre><code class="language-solidity">modifier onlyDuringBootstrap(uint8 _code);
</code></pre>
<h3 id="onlymigration"><a class="header" href="#onlymigration">onlyMigration</a></h3>
<p>Modifier to check if the caller is the migration contract.</p>
<pre><code class="language-solidity">modifier onlyMigration();
</code></pre>
<h3 id="nonreentrant"><a class="header" href="#nonreentrant">nonReentrant</a></h3>
<p><em>Reentrancy guard for nonReentrant functions.
see https://soliditylang.org/blog/2024/01/26/transient-storage/</em></p>
<pre><code class="language-solidity">modifier nonReentrant(uint8 _code);
</code></pre>
<h3 id="constructor-4"><a class="header" href="#constructor-4">constructor</a></h3>
<p>Constructor for the Hub contract.</p>
<pre><code class="language-solidity">constructor(
    IHubV1 _hubV1,
    INameRegistry _nameRegistry,
    address _migration,
    IERC20Lift _liftERC20,
    address _standardTreasury,
    uint256 _inflationDayZero,
    uint256 _bootstrapTime,
    string memory _gatewayUrl
) Circles(_inflationDayZero, _gatewayUrl);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_hubV1</code></td><td><code>IHubV1</code></td><td>address of the Hub v1 contract</td></tr>
<tr><td><code>_nameRegistry</code></td><td><code>INameRegistry</code></td><td></td></tr>
<tr><td><code>_migration</code></td><td><code>address</code></td><td></td></tr>
<tr><td><code>_liftERC20</code></td><td><code>IERC20Lift</code></td><td></td></tr>
<tr><td><code>_standardTreasury</code></td><td><code>address</code></td><td>address of the standard treasury contract</td></tr>
<tr><td><code>_inflationDayZero</code></td><td><code>uint256</code></td><td>timestamp of the start of the global inflation curve. For deployment on Gnosis Chain this parameter should be set to midnight 15 October 2020, or in unix time 1602786330 (deployment at 6:25:30 pm UTC) - 66330 (offset to midnight) = 1602720000.</td></tr>
<tr><td><code>_bootstrapTime</code></td><td><code>uint256</code></td><td>duration of the bootstrap period (for v1 registration) in seconds</td></tr>
<tr><td><code>_gatewayUrl</code></td><td><code>string</code></td><td>gateway URL string for the ERC1155 metadata mirroring IPFS metadata storage (eg. "https://gateway.aboutcircles.com/v2/circles/{id}.json")</td></tr>
</tbody></table>
</div>
<h3 id="registerhuman"><a class="header" href="#registerhuman">registerHuman</a></h3>
<p>Register human allows to register an avatar for a human,
if they have a stopped v1 Circles contract, during the bootstrap period.</p>
<pre><code class="language-solidity">function registerHuman(bytes32 _metatdataDigest) external onlyDuringBootstrap(0);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_metatdataDigest</code></td><td><code>bytes32</code></td><td>(optional) sha256 metadata digest for the avatar metadata should follow ERC1155 metadata standard.</td></tr>
</tbody></table>
</div>
<h3 id="invitehuman"><a class="header" href="#invitehuman">inviteHuman</a></h3>
<p>Invite human allows to register another human avatar.
The inviter must burn twice the welcome bonus of their own Circles,
and the invited human receives the welcome bonus in their personal Circles.
The inviter is set to trust the invited avatar.</p>
<pre><code class="language-solidity">function inviteHuman(address _human) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_human</code></td><td><code>address</code></td><td>avatar of the human to invite</td></tr>
</tbody></table>
</div>
<h3 id="registergroup"><a class="header" href="#registergroup">registerGroup</a></h3>
<p>Register group allows to register a group avatar.</p>
<pre><code class="language-solidity">function registerGroup(address _mint, string calldata _name, string calldata _symbol, bytes32 _metatdataDigest)
    external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_mint</code></td><td><code>address</code></td><td>mint address will be called before minting group circles</td></tr>
<tr><td><code>_name</code></td><td><code>string</code></td><td>immutable name of the group Circles</td></tr>
<tr><td><code>_symbol</code></td><td><code>string</code></td><td>immutable symbol of the group Circles</td></tr>
<tr><td><code>_metatdataDigest</code></td><td><code>bytes32</code></td><td>sha256 digest for the group metadata</td></tr>
</tbody></table>
</div>
<h3 id="registercustomgroup"><a class="header" href="#registercustomgroup">registerCustomGroup</a></h3>
<p>Register custom group allows to register a group with a custom treasury contract.</p>
<pre><code class="language-solidity">function registerCustomGroup(
    address _mint,
    address _treasury,
    string calldata _name,
    string calldata _symbol,
    bytes32 _metatdataDigest
) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_mint</code></td><td><code>address</code></td><td>mint address will be called before minting group circles</td></tr>
<tr><td><code>_treasury</code></td><td><code>address</code></td><td>treasury address for receiving collateral</td></tr>
<tr><td><code>_name</code></td><td><code>string</code></td><td>immutable name of the group Circles</td></tr>
<tr><td><code>_symbol</code></td><td><code>string</code></td><td>immutable symbol of the group Circles</td></tr>
<tr><td><code>_metatdataDigest</code></td><td><code>bytes32</code></td><td>metadata digest for the group metadata</td></tr>
</tbody></table>
</div>
<h3 id="registerorganization"><a class="header" href="#registerorganization">registerOrganization</a></h3>
<p>Register organization allows to register an organization avatar.</p>
<pre><code class="language-solidity">function registerOrganization(string calldata _name, bytes32 _metatdataDigest) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_name</code></td><td><code>string</code></td><td>name of the organization</td></tr>
<tr><td><code>_metatdataDigest</code></td><td><code>bytes32</code></td><td>Metadata digest for the organization metadata</td></tr>
</tbody></table>
</div>
<h3 id="trust"><a class="header" href="#trust">trust</a></h3>
<p>Trust allows to trust another address for a certain period of time.
Expiry times in the past are set to the current block timestamp.</p>
<p><em>Trust is directional and can be set by the caller to any address.
The trusted address does not (yet) have to be registered in the Hub contract.</em></p>
<pre><code class="language-solidity">function trust(address _trustReceiver, uint96 _expiry) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_trustReceiver</code></td><td><code>address</code></td><td>address that is trusted by the caller</td></tr>
<tr><td><code>_expiry</code></td><td><code>uint96</code></td><td>expiry time in seconds since unix epoch until when trust is valid</td></tr>
</tbody></table>
</div>
<h3 id="personalmint-1"><a class="header" href="#personalmint-1">personalMint</a></h3>
<p>Personal mint allows to mint personal Circles for a registered human avatar.</p>
<pre><code class="language-solidity">function personalMint() external;
</code></pre>
<h3 id="calculateissuancewithcheck"><a class="header" href="#calculateissuancewithcheck">calculateIssuanceWithCheck</a></h3>
<p>Calculate issuance allows to calculate the issuance for a human avatar with a check
to update the v1 mint status if updated.</p>
<pre><code class="language-solidity">function calculateIssuanceWithCheck(address _human) external returns (uint256, uint256, uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_human</code></td><td><code>address</code></td><td>address of the human avatar to calculate the issuance for</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>issuance amount of Circles that can be minted</td></tr>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>startPeriod start of the claimable period</td></tr>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>endPeriod end of the claimable period</td></tr>
</tbody></table>
</div>
<h3 id="groupmint"><a class="header" href="#groupmint">groupMint</a></h3>
<p>Group mint allows to mint group Circles by providing the required collateral.</p>
<pre><code class="language-solidity">function groupMint(
    address _group,
    address[] calldata _collateralAvatars,
    uint256[] calldata _amounts,
    bytes calldata _data
) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_group</code></td><td><code>address</code></td><td>address of the group avatar to mint Circles of</td></tr>
<tr><td><code>_collateralAvatars</code></td><td><code>address[]</code></td><td>array of (personal or group) avatar addresses to be used as collateral</td></tr>
<tr><td><code>_amounts</code></td><td><code>uint256[]</code></td><td>array of amounts of collateral to be used for minting</td></tr>
<tr><td><code>_data</code></td><td><code>bytes</code></td><td>(optional) additional data to be passed to the mint policy, treasury and minter</td></tr>
</tbody></table>
</div>
<h3 id="stop"><a class="header" href="#stop">stop</a></h3>
<p>Stop allows to stop future mints of personal Circles for this avatar.
Must be called by the avatar itself. This action is irreversible.</p>
<pre><code class="language-solidity">function stop() external;
</code></pre>
<h3 id="stopped"><a class="header" href="#stopped">stopped</a></h3>
<p>Stopped checks whether the avatar has stopped future mints of personal Circles.</p>
<pre><code class="language-solidity">function stopped(address _human) external view returns (bool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_human</code></td><td><code>address</code></td><td>address of avatar of the human to check whether it is stopped</td></tr>
</tbody></table>
</div>
<h3 id="migrate"><a class="header" href="#migrate">migrate</a></h3>
<p>Migrate allows to migrate v1 Circles to v2 Circles. During bootstrap period,
no invitation cost needs to be paid for new humans to be registered. After the bootstrap
period the same invitation cost applies as for normal invitations, and this requires the
owner to be a human and to have enough personal Circles to pay the invitation cost.
Organizations and groups have to ensure all humans have been registered after the bootstrap period.
Can only be called by the migration contract.</p>
<pre><code class="language-solidity">function migrate(address _owner, address[] calldata _avatars, uint256[] calldata _amounts) external onlyMigration;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_owner</code></td><td><code>address</code></td><td>address of the owner of the v1 Circles and beneficiary of the v2 Circles</td></tr>
<tr><td><code>_avatars</code></td><td><code>address[]</code></td><td>array of avatar addresses to migrate</td></tr>
<tr><td><code>_amounts</code></td><td><code>uint256[]</code></td><td>array of amounts in inflationary v1 units to migrate</td></tr>
</tbody></table>
</div>
<h3 id="burn"><a class="header" href="#burn">burn</a></h3>
<p>Burn allows to burn Circles owned by the caller.</p>
<pre><code class="language-solidity">function burn(uint256 _id, uint256 _amount, bytes calldata _data) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_id</code></td><td><code>uint256</code></td><td>Circles identifier of the Circles to burn</td></tr>
<tr><td><code>_amount</code></td><td><code>uint256</code></td><td>amount of Circles to burn</td></tr>
<tr><td><code>_data</code></td><td><code>bytes</code></td><td>(optional) additional data to be passed to the burn policy if they are group Circles</td></tr>
</tbody></table>
</div>
<h3 id="wrap"><a class="header" href="#wrap">wrap</a></h3>
<pre><code class="language-solidity">function wrap(address _avatar, uint256 _amount, CirclesType _type) external returns (address);
</code></pre>
<h3 id="operateflowmatrix"><a class="header" href="#operateflowmatrix">operateFlowMatrix</a></h3>
<pre><code class="language-solidity">function operateFlowMatrix(
    address[] calldata _flowVertices,
    FlowEdge[] calldata _flow,
    Stream[] calldata _streams,
    bytes calldata _packedCoordinates
) external nonReentrant(0);
</code></pre>
<h3 id="setadvancedusageflag"><a class="header" href="#setadvancedusageflag">setAdvancedUsageFlag</a></h3>
<pre><code class="language-solidity">function setAdvancedUsageFlag(bytes32 _flag) external;
</code></pre>
<h3 id="ishuman"><a class="header" href="#ishuman">isHuman</a></h3>
<p>Checks if an avatar is registered as a human.</p>
<pre><code class="language-solidity">function isHuman(address _human) public view returns (bool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_human</code></td><td><code>address</code></td><td>address of the human to check</td></tr>
</tbody></table>
</div>
<h3 id="isgroup"><a class="header" href="#isgroup">isGroup</a></h3>
<p>Checks if an avatar is registered as a group.</p>
<pre><code class="language-solidity">function isGroup(address _group) public view returns (bool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_group</code></td><td><code>address</code></td><td>address of the group to check</td></tr>
</tbody></table>
</div>
<h3 id="isorganization"><a class="header" href="#isorganization">isOrganization</a></h3>
<p>Checks if an avatar is registered as an organization.</p>
<pre><code class="language-solidity">function isOrganization(address _organization) public view returns (bool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_organization</code></td><td><code>address</code></td><td>address of the organization to check</td></tr>
</tbody></table>
</div>
<h3 id="istrusted"><a class="header" href="#istrusted">isTrusted</a></h3>
<p>Returns true if the truster trusts the trustee.</p>
<pre><code class="language-solidity">function isTrusted(address _truster, address _trustee) public view returns (bool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_truster</code></td><td><code>address</code></td><td>Address of the trusting account</td></tr>
<tr><td><code>_trustee</code></td><td><code>address</code></td><td>Address of the trusted account</td></tr>
</tbody></table>
</div>
<h3 id="ispermittedflow"><a class="header" href="#ispermittedflow">isPermittedFlow</a></h3>
<pre><code class="language-solidity">function isPermittedFlow(address _to, address _circlesAvatar) public view returns (bool);
</code></pre>
<h3 id="_groupmint"><a class="header" href="#_groupmint">_groupMint</a></h3>
<p>Group mint allows to mint group Circles by providing the required collateral.</p>
<pre><code class="language-solidity">function _groupMint(
    address _sender,
    address _group,
    uint256[] memory _collateral,
    uint256[] memory _amounts,
    bytes memory _data
) internal;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_sender</code></td><td><code>address</code></td><td>address of the sender of the group mint, and receiver of minted group Circles</td></tr>
<tr><td><code>_group</code></td><td><code>address</code></td><td>address of the group avatar to mint Circles of</td></tr>
<tr><td><code>_collateral</code></td><td><code>uint256[]</code></td><td>array of (personal or group) avatar addresses to be used as collateral</td></tr>
<tr><td><code>_amounts</code></td><td><code>uint256[]</code></td><td>array of amounts of collateral to be used for minting</td></tr>
<tr><td><code>_data</code></td><td><code>bytes</code></td><td>(optional) additional data to be passed to the mint policy, treasury and minter</td></tr>
</tbody></table>
</div>
<h3 id="_verifyflowmatrix"><a class="header" href="#_verifyflowmatrix">_verifyFlowMatrix</a></h3>
<pre><code class="language-solidity">function _verifyFlowMatrix(
    address[] calldata _flowVertices,
    FlowEdge[] calldata _flow,
    uint16[] memory _coordinates,
    bool _closedPath
) internal view returns (int256[] memory);
</code></pre>
<h3 id="_effectpathtransfers"><a class="header" href="#_effectpathtransfers">_effectPathTransfers</a></h3>
<pre><code class="language-solidity">function _effectPathTransfers(
    address[] calldata _flowVertices,
    FlowEdge[] calldata _flow,
    Stream[] calldata _streams,
    uint16[] memory _coordinates
) internal;
</code></pre>
<h3 id="_callacceptancechecks"><a class="header" href="#_callacceptancechecks">_callAcceptanceChecks</a></h3>
<pre><code class="language-solidity">function _callAcceptanceChecks(
    address[] calldata _flowVertices,
    FlowEdge[] calldata _flow,
    Stream[] calldata _streams,
    uint16[] memory _coordinates
) internal returns (int256[] memory);
</code></pre>
<h3 id="_matchnettedflows"><a class="header" href="#_matchnettedflows">_matchNettedFlows</a></h3>
<pre><code class="language-solidity">function _matchNettedFlows(int256[] memory _streamsNettedFlow, int256[] memory _matrixNettedFlow) internal pure;
</code></pre>
<h3 id="_registerhuman"><a class="header" href="#_registerhuman">_registerHuman</a></h3>
<p>Register human allows to register an avatar for a human,
and returns the status of the associated v1 Circles contract.
Additionally set the trust to self indefinitely.</p>
<pre><code class="language-solidity">function _registerHuman(address _human) internal returns (address v1CirclesStatus);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_human</code></td><td><code>address</code></td><td>address of the human to be registered</td></tr>
</tbody></table>
</div>
<h3 id="_registergroup"><a class="header" href="#_registergroup">_registerGroup</a></h3>
<p>Register a group avatar.</p>
<pre><code class="language-solidity">function _registerGroup(
    address _avatar,
    address _mint,
    address _treasury,
    string calldata _name,
    string calldata _symbol
) internal;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_avatar</code></td><td><code>address</code></td><td>address of the group registering</td></tr>
<tr><td><code>_mint</code></td><td><code>address</code></td><td>address of the mint policy for the group</td></tr>
<tr><td><code>_treasury</code></td><td><code>address</code></td><td>address of the treasury for the group</td></tr>
<tr><td><code>_name</code></td><td><code>string</code></td><td>name of the group Circles</td></tr>
<tr><td><code>_symbol</code></td><td><code>string</code></td><td>symbol of the group Circles</td></tr>
</tbody></table>
</div>
<h3 id="_trust"><a class="header" href="#_trust">_trust</a></h3>
<pre><code class="language-solidity">function _trust(address _truster, address _trustee, uint96 _expiry) internal;
</code></pre>
<h3 id="_ensureavatarsregistered"><a class="header" href="#_ensureavatarsregistered">_ensureAvatarsRegistered</a></h3>
<pre><code class="language-solidity">function _ensureAvatarsRegistered(address[] calldata _avatars) internal returns (uint256);
</code></pre>
<h3 id="_checkhumanv1circlesstatus"><a class="header" href="#_checkhumanv1circlesstatus">_checkHumanV1CirclesStatus</a></h3>
<p>Check the status of an avatar's Circles in the Hub v1 contract,
and update the mint status of the avatar.</p>
<pre><code class="language-solidity">function _checkHumanV1CirclesStatus(address _human) internal;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_human</code></td><td><code>address</code></td><td>Address of the human avatar to check the v1 mint status of.</td></tr>
</tbody></table>
</div>
<h3 id="_avatarv1circlesstatus"><a class="header" href="#_avatarv1circlesstatus">_avatarV1CirclesStatus</a></h3>
<p>Checks the status of an avatar's Circles in the Hub v1 contract,
and returns the address of the Circles if it exists and is not stopped.
Else, it returns the zero address if no Circles exist,
and it returns the address CIRCLES_STOPPED_V1 (0x1) if the Circles contract is stopped.</p>
<pre><code class="language-solidity">function _avatarV1CirclesStatus(address _avatar) internal view returns (address);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_avatar</code></td><td><code>address</code></td><td>avatar address for which to check registration in Hub v1</td></tr>
</tbody></table>
</div>
<h3 id="_updatemintv1status"><a class="header" href="#_updatemintv1status">_updateMintV1Status</a></h3>
<p>Update the mint status of an avatar given the status of the v1 Circles contract.</p>
<pre><code class="language-solidity">function _updateMintV1Status(address _human, address _mintV1Status) internal;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_human</code></td><td><code>address</code></td><td>Address of the human avatar to check the v1 mint status of.</td></tr>
<tr><td><code>_mintV1Status</code></td><td><code>address</code></td><td>Mint status of the v1 Circles contract.</td></tr>
</tbody></table>
</div>
<h3 id="_insertavatar"><a class="header" href="#_insertavatar">_insertAvatar</a></h3>
<p>Insert an avatar into the linked list of avatars.
Reverts on inserting duplicates.</p>
<pre><code class="language-solidity">function _insertAvatar(address _avatar) internal;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_avatar</code></td><td><code>address</code></td><td>avatar address to insert</td></tr>
</tbody></table>
</div>
<h3 id="_validateaddressfromid"><a class="header" href="#_validateaddressfromid">_validateAddressFromId</a></h3>
<pre><code class="language-solidity">function _validateAddressFromId(uint256 _id, uint8 _code) internal pure returns (address);
</code></pre>
<h3 id="_unpackcoordinates"><a class="header" href="#_unpackcoordinates">_unpackCoordinates</a></h3>
<p><em>abi.encodePacked of an array uint16[] would still pad each uint16 - I think;
if abi packing does not add padding this function is redundant and should be thrown out
Unpacks the packed coordinates from bytes.
Each coordinate is 16 bits, and each triplet is thus 48 bits.</em></p>
<pre><code class="language-solidity">function _unpackCoordinates(bytes calldata _packedData, uint256 _numberOfTriplets)
    internal
    pure
    returns (uint16[] memory unpackedCoordinates_);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_packedData</code></td><td><code>bytes</code></td><td>The packed data containing the coordinates.</td></tr>
<tr><td><code>_numberOfTriplets</code></td><td><code>uint256</code></td><td>The number of coordinate triplets in the packed data.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>unpackedCoordinates_</code></td><td><code>uint16[]</code></td><td>An array of unpacked coordinates (of length 3* numberOfTriplets)</td></tr>
</tbody></table>
</div>
<h3 id="_upserttrustmarker"><a class="header" href="#_upserttrustmarker">_upsertTrustMarker</a></h3>
<p><em>Internal function to upsert a trust marker for a truster and a trusted address.
It will initialize the linked list for the truster if it does not exist yet.
If the trustee is not yet trusted by the truster, it will insert the trust marker.
It will update the expiry time for the trusted address.</em></p>
<pre><code class="language-solidity">function _upsertTrustMarker(address _truster, address _trusted, uint96 _expiry) private;
</code></pre>
<h2 id="events-2"><a class="header" href="#events-2">Events</a></h2>
<h3 id="registerhuman-1"><a class="header" href="#registerhuman-1">RegisterHuman</a></h3>
<pre><code class="language-solidity">event RegisterHuman(address indexed avatar);
</code></pre>
<h3 id="invitehuman-1"><a class="header" href="#invitehuman-1">InviteHuman</a></h3>
<pre><code class="language-solidity">event InviteHuman(address indexed inviter, address indexed invited);
</code></pre>
<h3 id="registerorganization-1"><a class="header" href="#registerorganization-1">RegisterOrganization</a></h3>
<pre><code class="language-solidity">event RegisterOrganization(address indexed organization, string name);
</code></pre>
<h3 id="registergroup-1"><a class="header" href="#registergroup-1">RegisterGroup</a></h3>
<pre><code class="language-solidity">event RegisterGroup(address indexed group, address indexed mint, address indexed treasury, string name, string symbol);
</code></pre>
<h3 id="trust-1"><a class="header" href="#trust-1">Trust</a></h3>
<pre><code class="language-solidity">event Trust(address indexed truster, address indexed trustee, uint256 expiryTime);
</code></pre>
<h3 id="stopped-1"><a class="header" href="#stopped-1">Stopped</a></h3>
<pre><code class="language-solidity">event Stopped(address indexed avatar);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ihubv2"><a class="header" href="#ihubv2">IHubV2</a></h1>
<p><a href="https://github.com/aboutcircles/circles-contracts-v2/blob/9fbbffb44eda7934ea8adf9354e5f09f6b15b8b2/src/hub/IHub.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
IERC1155, <a href="src/hub/IHub.sol//src/circles/ICircles.sol/interface.ICircles.html">ICircles</a></p>
<h2 id="functions-8"><a class="header" href="#functions-8">Functions</a></h2>
<h3 id="avatars-1"><a class="header" href="#avatars-1">avatars</a></h3>
<pre><code class="language-solidity">function avatars(address avatar) external view returns (address);
</code></pre>
<h3 id="ishuman-1"><a class="header" href="#ishuman-1">isHuman</a></h3>
<pre><code class="language-solidity">function isHuman(address avatar) external view returns (bool);
</code></pre>
<h3 id="isgroup-1"><a class="header" href="#isgroup-1">isGroup</a></h3>
<pre><code class="language-solidity">function isGroup(address avatar) external view returns (bool);
</code></pre>
<h3 id="isorganization-1"><a class="header" href="#isorganization-1">isOrganization</a></h3>
<pre><code class="language-solidity">function isOrganization(address avatar) external view returns (bool);
</code></pre>
<h3 id="migrate-1"><a class="header" href="#migrate-1">migrate</a></h3>
<pre><code class="language-solidity">function migrate(address owner, address[] calldata avatars, uint256[] calldata amounts) external;
</code></pre>
<h3 id="mintpolicies-1"><a class="header" href="#mintpolicies-1">mintPolicies</a></h3>
<pre><code class="language-solidity">function mintPolicies(address avatar) external view returns (address);
</code></pre>
<h3 id="burn-1"><a class="header" href="#burn-1">burn</a></h3>
<pre><code class="language-solidity">function burn(uint256 id, uint256 amount, bytes calldata data) external;
</code></pre>
<h3 id="operateflowmatrix-1"><a class="header" href="#operateflowmatrix-1">operateFlowMatrix</a></h3>
<pre><code class="language-solidity">function operateFlowMatrix(
    address[] calldata _flowVertices,
    TypeDefinitions.FlowEdge[] calldata _flow,
    TypeDefinitions.Stream[] calldata _streams,
    bytes calldata _packedCoordinates
) external;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="typedefinitions"><a class="header" href="#typedefinitions">TypeDefinitions</a></h1>
<p><a href="https://github.com/aboutcircles/circles-contracts-v2/blob/9fbbffb44eda7934ea8adf9354e5f09f6b15b8b2/src/hub/TypeDefinitions.sol">Git Source</a></p>
<h2 id="state-variables-5"><a class="header" href="#state-variables-5">State Variables</a></h2>
<h3 id="metadatatype_groupmint"><a class="header" href="#metadatatype_groupmint">METADATATYPE_GROUPMINT</a></h3>
<pre><code class="language-solidity">bytes32 internal constant METADATATYPE_GROUPMINT = keccak256("CIRCLESv2:RESERVED_DATA:CirclesGroupMint");
</code></pre>
<h3 id="metadatatype_groupredeem"><a class="header" href="#metadatatype_groupredeem">METADATATYPE_GROUPREDEEM</a></h3>
<pre><code class="language-solidity">bytes32 internal constant METADATATYPE_GROUPREDEEM = keccak256("CIRCLESv2:RESERVED_DATA:CirclesGroupRedeem");
</code></pre>
<h2 id="structs-3"><a class="header" href="#structs-3">Structs</a></h2>
<h3 id="trustmarker"><a class="header" href="#trustmarker">TrustMarker</a></h3>
<p>TrustMarker stores the expiry of a trust relation as uint96,
and is iterable as a linked list of trust markers.</p>
<p><em>This is used to store the directional trust relation between two avatars,
and the expiry of the trust relation as uint96 in unix time.</em></p>
<pre><code class="language-solidity">struct TrustMarker {
    address previous;
    uint96 expiry;
}
</code></pre>
<h3 id="flowedge"><a class="header" href="#flowedge">FlowEdge</a></h3>
<pre><code class="language-solidity">struct FlowEdge {
    uint16 streamSinkId;
    uint192 amount;
}
</code></pre>
<h3 id="stream"><a class="header" href="#stream">Stream</a></h3>
<pre><code class="language-solidity">struct Stream {
    uint16 sourceCoordinate;
    uint16[] flowEdgeIds;
    bytes data;
}
</code></pre>
<h3 id="metadata"><a class="header" href="#metadata">Metadata</a></h3>
<pre><code class="language-solidity">struct Metadata {
    bytes32 metadataType;
    bytes metadata;
    bytes erc1155UserData;
}
</code></pre>
<h3 id="groupmintmetadata"><a class="header" href="#groupmintmetadata">GroupMintMetadata</a></h3>
<pre><code class="language-solidity">struct GroupMintMetadata {
    address group;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents-4"><a class="header" href="#contents-4">Contents</a></h1>
<ul>
<li><a href="src/lib/Math64x64.sol/library.Math64x64.html">Math64x64</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="math64x64"><a class="header" href="#math64x64">Math64x64</a></h1>
<p><a href="https://github.com/aboutcircles/circles-contracts-v2/blob/9fbbffb44eda7934ea8adf9354e5f09f6b15b8b2/src/lib/Math64x64.sol">Git Source</a></p>
<p>Smart contract library of mathematical functions operating with signed
64.64-bit fixed point numbers.  Signed 64.64-bit fixed point number is
basically a simple fraction whose numerator is signed 128-bit integer and
denominator is 2^64.  As long as denominator is always the same, there is no
need to store it, thus in Solidity signed 64.64-bit fixed point numbers are
represented by int128 type holding only the numerator.</p>
<h2 id="state-variables-6"><a class="header" href="#state-variables-6">State Variables</a></h2>
<h3 id="min_64x64"><a class="header" href="#min_64x64">MIN_64x64</a></h3>
<pre><code class="language-solidity">int128 private constant MIN_64x64 = -0x80000000000000000000000000000000;
</code></pre>
<h3 id="max_64x64"><a class="header" href="#max_64x64">MAX_64x64</a></h3>
<pre><code class="language-solidity">int128 private constant MAX_64x64 = 0x7FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF;
</code></pre>
<h2 id="functions-9"><a class="header" href="#functions-9">Functions</a></h2>
<h3 id="fromint"><a class="header" href="#fromint">fromInt</a></h3>
<p>Convert signed 256-bit integer number into signed 64.64-bit fixed point
number.  Revert on overflow.</p>
<pre><code class="language-solidity">function fromInt(int256 x) internal pure returns (int128);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>x</code></td><td><code>int256</code></td><td>signed 256-bit integer number</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>int128</code></td><td>signed 64.64-bit fixed point number</td></tr>
</tbody></table>
</div>
<h3 id="toint"><a class="header" href="#toint">toInt</a></h3>
<p>Convert signed 64.64 fixed point number into signed 64-bit integer number
rounding down.</p>
<pre><code class="language-solidity">function toInt(int128 x) internal pure returns (int64);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>x</code></td><td><code>int128</code></td><td>signed 64.64-bit fixed point number</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>int64</code></td><td>signed 64-bit integer number</td></tr>
</tbody></table>
</div>
<h3 id="fromuint"><a class="header" href="#fromuint">fromUInt</a></h3>
<p>Convert unsigned 256-bit integer number into signed 64.64-bit fixed point
number.  Revert on overflow.</p>
<pre><code class="language-solidity">function fromUInt(uint256 x) internal pure returns (int128);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>x</code></td><td><code>uint256</code></td><td>unsigned 256-bit integer number</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>int128</code></td><td>signed 64.64-bit fixed point number</td></tr>
</tbody></table>
</div>
<h3 id="touint"><a class="header" href="#touint">toUInt</a></h3>
<p>Convert signed 64.64 fixed point number into unsigned 64-bit integer
number rounding down.  Revert on underflow.</p>
<pre><code class="language-solidity">function toUInt(int128 x) internal pure returns (uint64);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>x</code></td><td><code>int128</code></td><td>signed 64.64-bit fixed point number</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint64</code></td><td>unsigned 64-bit integer number</td></tr>
</tbody></table>
</div>
<h3 id="from128x128"><a class="header" href="#from128x128">from128x128</a></h3>
<p>Convert signed 128.128 fixed point number into signed 64.64-bit fixed point
number rounding down.  Revert on overflow.</p>
<pre><code class="language-solidity">function from128x128(int256 x) internal pure returns (int128);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>x</code></td><td><code>int256</code></td><td>signed 128.128-bin fixed point number</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>int128</code></td><td>signed 64.64-bit fixed point number</td></tr>
</tbody></table>
</div>
<h3 id="to128x128"><a class="header" href="#to128x128">to128x128</a></h3>
<p>Convert signed 64.64 fixed point number into signed 128.128 fixed point
number.</p>
<pre><code class="language-solidity">function to128x128(int128 x) internal pure returns (int256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>x</code></td><td><code>int128</code></td><td>signed 64.64-bit fixed point number</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>int256</code></td><td>signed 128.128 fixed point number</td></tr>
</tbody></table>
</div>
<h3 id="add"><a class="header" href="#add">add</a></h3>
<p>Calculate x + y.  Revert on overflow.</p>
<pre><code class="language-solidity">function add(int128 x, int128 y) internal pure returns (int128);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>x</code></td><td><code>int128</code></td><td>signed 64.64-bit fixed point number</td></tr>
<tr><td><code>y</code></td><td><code>int128</code></td><td>signed 64.64-bit fixed point number</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>int128</code></td><td>signed 64.64-bit fixed point number</td></tr>
</tbody></table>
</div>
<h3 id="sub"><a class="header" href="#sub">sub</a></h3>
<p>Calculate x - y.  Revert on overflow.</p>
<pre><code class="language-solidity">function sub(int128 x, int128 y) internal pure returns (int128);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>x</code></td><td><code>int128</code></td><td>signed 64.64-bit fixed point number</td></tr>
<tr><td><code>y</code></td><td><code>int128</code></td><td>signed 64.64-bit fixed point number</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>int128</code></td><td>signed 64.64-bit fixed point number</td></tr>
</tbody></table>
</div>
<h3 id="mul"><a class="header" href="#mul">mul</a></h3>
<p>Calculate x * y rounding down.  Revert on overflow.</p>
<pre><code class="language-solidity">function mul(int128 x, int128 y) internal pure returns (int128);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>x</code></td><td><code>int128</code></td><td>signed 64.64-bit fixed point number</td></tr>
<tr><td><code>y</code></td><td><code>int128</code></td><td>signed 64.64-bit fixed point number</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>int128</code></td><td>signed 64.64-bit fixed point number</td></tr>
</tbody></table>
</div>
<h3 id="muli"><a class="header" href="#muli">muli</a></h3>
<p>Calculate x * y rounding towards zero, where x is signed 64.64 fixed point
number and y is signed 256-bit integer number.  Revert on overflow.</p>
<pre><code class="language-solidity">function muli(int128 x, int256 y) internal pure returns (int256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>x</code></td><td><code>int128</code></td><td>signed 64.64 fixed point number</td></tr>
<tr><td><code>y</code></td><td><code>int256</code></td><td>signed 256-bit integer number</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>int256</code></td><td>signed 256-bit integer number</td></tr>
</tbody></table>
</div>
<h3 id="mulu"><a class="header" href="#mulu">mulu</a></h3>
<p>Calculate x * y rounding down, where x is signed 64.64 fixed point number
and y is unsigned 256-bit integer number.  Revert on overflow.</p>
<pre><code class="language-solidity">function mulu(int128 x, uint256 y) internal pure returns (uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>x</code></td><td><code>int128</code></td><td>signed 64.64 fixed point number</td></tr>
<tr><td><code>y</code></td><td><code>uint256</code></td><td>unsigned 256-bit integer number</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>unsigned 256-bit integer number</td></tr>
</tbody></table>
</div>
<h3 id="div"><a class="header" href="#div">div</a></h3>
<p>Calculate x / y rounding towards zero.  Revert on overflow or when y is
zero.</p>
<pre><code class="language-solidity">function div(int128 x, int128 y) internal pure returns (int128);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>x</code></td><td><code>int128</code></td><td>signed 64.64-bit fixed point number</td></tr>
<tr><td><code>y</code></td><td><code>int128</code></td><td>signed 64.64-bit fixed point number</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>int128</code></td><td>signed 64.64-bit fixed point number</td></tr>
</tbody></table>
</div>
<h3 id="divi"><a class="header" href="#divi">divi</a></h3>
<p>Calculate x / y rounding towards zero, where x and y are signed 256-bit
integer numbers.  Revert on overflow or when y is zero.</p>
<pre><code class="language-solidity">function divi(int256 x, int256 y) internal pure returns (int128);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>x</code></td><td><code>int256</code></td><td>signed 256-bit integer number</td></tr>
<tr><td><code>y</code></td><td><code>int256</code></td><td>signed 256-bit integer number</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>int128</code></td><td>signed 64.64-bit fixed point number</td></tr>
</tbody></table>
</div>
<h3 id="divu"><a class="header" href="#divu">divu</a></h3>
<p>Calculate x / y rounding towards zero, where x and y are unsigned 256-bit
integer numbers.  Revert on overflow or when y is zero.</p>
<pre><code class="language-solidity">function divu(uint256 x, uint256 y) internal pure returns (int128);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>x</code></td><td><code>uint256</code></td><td>unsigned 256-bit integer number</td></tr>
<tr><td><code>y</code></td><td><code>uint256</code></td><td>unsigned 256-bit integer number</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>int128</code></td><td>signed 64.64-bit fixed point number</td></tr>
</tbody></table>
</div>
<h3 id="neg"><a class="header" href="#neg">neg</a></h3>
<p>Calculate -x.  Revert on overflow.</p>
<pre><code class="language-solidity">function neg(int128 x) internal pure returns (int128);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>x</code></td><td><code>int128</code></td><td>signed 64.64-bit fixed point number</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>int128</code></td><td>signed 64.64-bit fixed point number</td></tr>
</tbody></table>
</div>
<h3 id="abs"><a class="header" href="#abs">abs</a></h3>
<p>Calculate |x|.  Revert on overflow.</p>
<pre><code class="language-solidity">function abs(int128 x) internal pure returns (int128);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>x</code></td><td><code>int128</code></td><td>signed 64.64-bit fixed point number</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>int128</code></td><td>signed 64.64-bit fixed point number</td></tr>
</tbody></table>
</div>
<h3 id="inv"><a class="header" href="#inv">inv</a></h3>
<p>Calculate 1 / x rounding towards zero.  Revert on overflow or when x is
zero.</p>
<pre><code class="language-solidity">function inv(int128 x) internal pure returns (int128);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>x</code></td><td><code>int128</code></td><td>signed 64.64-bit fixed point number</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>int128</code></td><td>signed 64.64-bit fixed point number</td></tr>
</tbody></table>
</div>
<h3 id="avg"><a class="header" href="#avg">avg</a></h3>
<p>Calculate arithmetics average of x and y, i.e. (x + y) / 2 rounding down.</p>
<pre><code class="language-solidity">function avg(int128 x, int128 y) internal pure returns (int128);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>x</code></td><td><code>int128</code></td><td>signed 64.64-bit fixed point number</td></tr>
<tr><td><code>y</code></td><td><code>int128</code></td><td>signed 64.64-bit fixed point number</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>int128</code></td><td>signed 64.64-bit fixed point number</td></tr>
</tbody></table>
</div>
<h3 id="gavg"><a class="header" href="#gavg">gavg</a></h3>
<p>Calculate geometric average of x and y, i.e. sqrt (x * y) rounding down.
Revert on overflow or in case x * y is negative.</p>
<pre><code class="language-solidity">function gavg(int128 x, int128 y) internal pure returns (int128);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>x</code></td><td><code>int128</code></td><td>signed 64.64-bit fixed point number</td></tr>
<tr><td><code>y</code></td><td><code>int128</code></td><td>signed 64.64-bit fixed point number</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>int128</code></td><td>signed 64.64-bit fixed point number</td></tr>
</tbody></table>
</div>
<h3 id="pow"><a class="header" href="#pow">pow</a></h3>
<p>Calculate x^y assuming 0^0 is 1, where x is signed 64.64 fixed point number
and y is unsigned 256-bit integer number.  Revert on overflow.</p>
<pre><code class="language-solidity">function pow(int128 x, uint256 y) internal pure returns (int128);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>x</code></td><td><code>int128</code></td><td>signed 64.64-bit fixed point number</td></tr>
<tr><td><code>y</code></td><td><code>uint256</code></td><td>uint256 value</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>int128</code></td><td>signed 64.64-bit fixed point number</td></tr>
</tbody></table>
</div>
<h3 id="sqrt"><a class="header" href="#sqrt">sqrt</a></h3>
<p>Calculate sqrt (x) rounding down.  Revert if x &lt; 0.</p>
<pre><code class="language-solidity">function sqrt(int128 x) internal pure returns (int128);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>x</code></td><td><code>int128</code></td><td>signed 64.64-bit fixed point number</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>int128</code></td><td>signed 64.64-bit fixed point number</td></tr>
</tbody></table>
</div>
<h3 id="log_2"><a class="header" href="#log_2">log_2</a></h3>
<p>Calculate binary logarithm of x.  Revert if x &lt;= 0.</p>
<pre><code class="language-solidity">function log_2(int128 x) internal pure returns (int128);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>x</code></td><td><code>int128</code></td><td>signed 64.64-bit fixed point number</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>int128</code></td><td>signed 64.64-bit fixed point number</td></tr>
</tbody></table>
</div>
<h3 id="ln"><a class="header" href="#ln">ln</a></h3>
<p>Calculate natural logarithm of x.  Revert if x &lt;= 0.</p>
<pre><code class="language-solidity">function ln(int128 x) internal pure returns (int128);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>x</code></td><td><code>int128</code></td><td>signed 64.64-bit fixed point number</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>int128</code></td><td>signed 64.64-bit fixed point number</td></tr>
</tbody></table>
</div>
<h3 id="exp_2"><a class="header" href="#exp_2">exp_2</a></h3>
<p>Calculate binary exponent of x.  Revert on overflow.</p>
<pre><code class="language-solidity">function exp_2(int128 x) internal pure returns (int128);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>x</code></td><td><code>int128</code></td><td>signed 64.64-bit fixed point number</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>int128</code></td><td>signed 64.64-bit fixed point number</td></tr>
</tbody></table>
</div>
<h3 id="exp"><a class="header" href="#exp">exp</a></h3>
<p>Calculate natural exponent of x.  Revert on overflow.</p>
<pre><code class="language-solidity">function exp(int128 x) internal pure returns (int128);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>x</code></td><td><code>int128</code></td><td>signed 64.64-bit fixed point number</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>int128</code></td><td>signed 64.64-bit fixed point number</td></tr>
</tbody></table>
</div>
<h3 id="divuu"><a class="header" href="#divuu">divuu</a></h3>
<p>Calculate x / y rounding towards zero, where x and y are unsigned 256-bit
integer numbers.  Revert on overflow or when y is zero.</p>
<pre><code class="language-solidity">function divuu(uint256 x, uint256 y) private pure returns (uint128);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>x</code></td><td><code>uint256</code></td><td>unsigned 256-bit integer number</td></tr>
<tr><td><code>y</code></td><td><code>uint256</code></td><td>unsigned 256-bit integer number</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint128</code></td><td>unsigned 64.64-bit fixed point number</td></tr>
</tbody></table>
</div>
<h3 id="sqrtu"><a class="header" href="#sqrtu">sqrtu</a></h3>
<p>Calculate sqrt (x) rounding down, where x is unsigned 256-bit integer
number.</p>
<pre><code class="language-solidity">function sqrtu(uint256 x) private pure returns (uint128);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>x</code></td><td><code>uint256</code></td><td>unsigned 256-bit integer number</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint128</code></td><td>unsigned 128-bit integer number</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="contents-5"><a class="header" href="#contents-5">Contents</a></h1>
<ul>
<li><a href="src/lift/DemurrageCircles.sol/contract.DemurrageCircles.html">DemurrageCircles</a></li>
<li><a href="src/lift/EIP712.sol/abstract.EIP712.html">EIP712</a></li>
<li><a href="src/lift/ERC20DiscountedBalances.sol/contract.ERC20DiscountedBalances.html">ERC20DiscountedBalances</a></li>
<li><a href="src/lift/ERC20InflationaryBalances.sol/contract.ERC20InflationaryBalances.html">ERC20InflationaryBalances</a></li>
<li><a href="src/lift/ERC20Lift.sol/contract.ERC20Lift.html">ERC20Lift</a></li>
<li><a href="src/lift/ERC20Permit.sol/contract.ERC20Permit.html">ERC20Permit</a></li>
<li><a href="src/lift/IERC20Lift.sol/enum.CirclesType.html">CirclesType</a></li>
<li><a href="src/lift/IERC20Lift.sol/interface.IERC20Lift.html">IERC20Lift</a></li>
<li><a href="src/lift/InflationaryCircles.sol/contract.InflationaryCircles.html">InflationaryCircles</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="demurragecircles"><a class="header" href="#demurragecircles">DemurrageCircles</a></h1>
<p><a href="https://github.com/aboutcircles/circles-contracts-v2/blob/9fbbffb44eda7934ea8adf9354e5f09f6b15b8b2/src/lift/DemurrageCircles.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="src/lift/DemurrageCircles.sol//src/proxy/MasterCopyNonUpgradable.sol/contract.MasterCopyNonUpgradable.html">MasterCopyNonUpgradable</a>, <a href="src/lift/DemurrageCircles.sol//src/lift/ERC20DiscountedBalances.sol/contract.ERC20DiscountedBalances.html">ERC20DiscountedBalances</a>, ERC1155Holder</p>
<h2 id="state-variables-7"><a class="header" href="#state-variables-7">State Variables</a></h2>
<h3 id="hub-1"><a class="header" href="#hub-1">hub</a></h3>
<pre><code class="language-solidity">IHubV2 public hub;
</code></pre>
<h3 id="nameregistry-1"><a class="header" href="#nameregistry-1">nameRegistry</a></h3>
<pre><code class="language-solidity">INameRegistry public nameRegistry;
</code></pre>
<h2 id="functions-10"><a class="header" href="#functions-10">Functions</a></h2>
<h3 id="onlyhub"><a class="header" href="#onlyhub">onlyHub</a></h3>
<pre><code class="language-solidity">modifier onlyHub(uint8 _code);
</code></pre>
<h3 id="constructor-5"><a class="header" href="#constructor-5">constructor</a></h3>
<pre><code class="language-solidity">constructor();
</code></pre>
<h3 id="setup"><a class="header" href="#setup">setup</a></h3>
<pre><code class="language-solidity">function setup(address _hub, address _nameRegistry, address _avatar) external;
</code></pre>
<h3 id="unwrap"><a class="header" href="#unwrap">unwrap</a></h3>
<pre><code class="language-solidity">function unwrap(uint256 _amount) external;
</code></pre>
<h3 id="totalsupply-1"><a class="header" href="#totalsupply-1">totalSupply</a></h3>
<pre><code class="language-solidity">function totalSupply() external view override returns (uint256);
</code></pre>
<h3 id="name"><a class="header" href="#name">name</a></h3>
<pre><code class="language-solidity">function name() external view returns (string memory);
</code></pre>
<h3 id="symbol"><a class="header" href="#symbol">symbol</a></h3>
<pre><code class="language-solidity">function symbol() external view returns (string memory);
</code></pre>
<h3 id="decimals-1"><a class="header" href="#decimals-1">decimals</a></h3>
<pre><code class="language-solidity">function decimals() external pure returns (uint8);
</code></pre>
<h3 id="onerc1155received"><a class="header" href="#onerc1155received">onERC1155Received</a></h3>
<pre><code class="language-solidity">function onERC1155Received(address, address _from, uint256 _id, uint256 _amount, bytes memory)
    public
    override
    onlyHub(0)
    returns (bytes4);
</code></pre>
<h3 id="onerc1155batchreceived"><a class="header" href="#onerc1155batchreceived">onERC1155BatchReceived</a></h3>
<pre><code class="language-solidity">function onERC1155BatchReceived(address, address, uint256[] memory, uint256[] memory, bytes memory)
    public
    view
    override
    onlyHub(1)
    returns (bytes4);
</code></pre>
<h3 id="circlesidentifier"><a class="header" href="#circlesidentifier">circlesIdentifier</a></h3>
<pre><code class="language-solidity">function circlesIdentifier() public view returns (uint256);
</code></pre>
<h2 id="events-3"><a class="header" href="#events-3">Events</a></h2>
<h3 id="depositdemurraged"><a class="header" href="#depositdemurraged">DepositDemurraged</a></h3>
<pre><code class="language-solidity">event DepositDemurraged(address indexed account, uint256 amount, uint256 inflationaryAmount);
</code></pre>
<h3 id="withdrawdemurraged"><a class="header" href="#withdrawdemurraged">WithdrawDemurraged</a></h3>
<pre><code class="language-solidity">event WithdrawDemurraged(address indexed account, uint256 amount, uint256 inflationaryAmount);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="eip712"><a class="header" href="#eip712">EIP712</a></h1>
<p><a href="https://github.com/aboutcircles/circles-contracts-v2/blob/9fbbffb44eda7934ea8adf9354e5f09f6b15b8b2/src/lift/EIP712.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
IERC5267</p>
<p><em>https://eips.ethereum.org/EIPS/eip-712[EIP 712] is a standard for hashing and signing of typed structured data.
The encoding scheme specified in the EIP requires a domain separator and a hash of the typed structured data, whose
encoding is very generic and therefore its implementation in Solidity is not feasible, thus this contract
does not implement the encoding itself. Protocols need to implement the type-specific encoding they need in order to
produce the hash of their typed data using a combination of <code>abi.encode</code> and <code>keccak256</code>.
This contract implements the EIP 712 domain separator (<a href="src/lift/EIP712.sol//src/lift/EIP712.sol/abstract.EIP712.html#_domainseparatorv4">_domainSeparatorV4</a>) that is used as part of the encoding
scheme, and the final step of the encoding to obtain the message digest that is then signed via ECDSA
({_hashTypedDataV4}).
The implementation of the domain separator was designed to be as efficient as possible while still properly updating
the chain id to protect against replay attacks on an eventual fork of the chain.
NOTE: This contract implements the version of the encoding known as "v4", as implemented by the JSON RPC method
https://docs.metamask.io/guide/signing-data.html[<code>eth_signTypedDataV4</code> in MetaMask].
NOTE: In the upgradeable version of this contract, the cached values will correspond to the address, and the domain
separator of the implementation contract. This will cause the {_domainSeparatorV4} function to always rebuild the
separator from the immutable values, which is cheaper than accessing a cached version in cold storage.</em></p>
<h2 id="state-variables-8"><a class="header" href="#state-variables-8">State Variables</a></h2>
<h3 id="type_hash"><a class="header" href="#type_hash">TYPE_HASH</a></h3>
<pre><code class="language-solidity">bytes32 private constant TYPE_HASH =
    keccak256("EIP712Domain(string name,string version,uint256 chainId,address verifyingContract)");
</code></pre>
<h3 id="_cacheddomainseparator"><a class="header" href="#_cacheddomainseparator">_cachedDomainSeparator</a></h3>
<pre><code class="language-solidity">bytes32 private _cachedDomainSeparator;
</code></pre>
<h3 id="_cachedchainid"><a class="header" href="#_cachedchainid">_cachedChainId</a></h3>
<pre><code class="language-solidity">uint256 private _cachedChainId;
</code></pre>
<h3 id="_cachedthis"><a class="header" href="#_cachedthis">_cachedThis</a></h3>
<pre><code class="language-solidity">address private _cachedThis;
</code></pre>
<h3 id="_hashedname"><a class="header" href="#_hashedname">_hashedName</a></h3>
<pre><code class="language-solidity">bytes32 private _hashedName;
</code></pre>
<h3 id="_hashedversion"><a class="header" href="#_hashedversion">_hashedVersion</a></h3>
<pre><code class="language-solidity">bytes32 private _hashedVersion;
</code></pre>
<h3 id="_name"><a class="header" href="#_name">_name</a></h3>
<pre><code class="language-solidity">ShortString private _name;
</code></pre>
<h3 id="_version"><a class="header" href="#_version">_version</a></h3>
<pre><code class="language-solidity">ShortString private _version;
</code></pre>
<h3 id="_namefallback"><a class="header" href="#_namefallback">_nameFallback</a></h3>
<pre><code class="language-solidity">string private _nameFallback;
</code></pre>
<h3 id="_versionfallback"><a class="header" href="#_versionfallback">_versionFallback</a></h3>
<pre><code class="language-solidity">string private _versionFallback;
</code></pre>
<h2 id="functions-11"><a class="header" href="#functions-11">Functions</a></h2>
<h3 id="constructor-6"><a class="header" href="#constructor-6">constructor</a></h3>
<pre><code class="language-solidity">constructor();
</code></pre>
<h3 id="_setupeip712"><a class="header" href="#_setupeip712">_setupEIP712</a></h3>
<p>*Initializes the domain separator and parameter caches.
The meaning of <code>name</code> and <code>version</code> is specified in
https://eips.ethereum.org/EIPS/eip-712#definition-of-domainseparator[EIP 712]:</p>
<ul>
<li><code>name</code>: the user readable name of the signing domain, i.e. the name of the DApp or the protocol.</li>
<li><code>version</code>: the current major version of the signing domain.
NOTE: These parameters cannot be changed except through a xref:learn::upgrading-smart-contracts.adoc[smart
contract upgrade].*</li>
</ul>
<pre><code class="language-solidity">function _setupEIP712(string memory name, string memory version) internal;
</code></pre>
<h3 id="eip712domain"><a class="header" href="#eip712domain">eip712Domain</a></h3>
<p><em>See {IERC-5267}.</em></p>
<pre><code class="language-solidity">function eip712Domain()
    public
    view
    virtual
    returns (
        bytes1 fields,
        string memory name,
        string memory version,
        uint256 chainId,
        address verifyingContract,
        bytes32 salt,
        uint256[] memory extensions
    );
</code></pre>
<h3 id="_domainseparatorv4"><a class="header" href="#_domainseparatorv4">_domainSeparatorV4</a></h3>
<p><em>Returns the domain separator for the current chain.</em></p>
<pre><code class="language-solidity">function _domainSeparatorV4() internal view returns (bytes32);
</code></pre>
<h3 id="_hashtypeddatav4"><a class="header" href="#_hashtypeddatav4">_hashTypedDataV4</a></h3>
<p>*Given an already https://eips.ethereum.org/EIPS/eip-712#definition-of-hashstruct[hashed struct], this
function returns the hash of the fully encoded EIP712 message for this domain.
This hash can be used together with <a href="src/lift/EIP712.sol//lib/openzeppelin-contracts/contracts/utils/cryptography/ECDSA.sol/library.ECDSA.html#recover">ECDSA-recover</a> to obtain the signer of a message. For example:</p>
<pre><code class="language-solidity">bytes32 digest = _hashTypedDataV4(keccak256(abi.encode(
keccak256("Mail(address to,string contents)"),
mailTo,
keccak256(bytes(mailContents))
)));
address signer = ECDSA.recover(digest, signature);
```*


```solidity
function _hashTypedDataV4(bytes32 structHash) internal view virtual returns (bytes32);
</code></pre>
<h3 id="_eip712name"><a class="header" href="#_eip712name">_EIP712Name</a></h3>
<p><em>The name parameter for the EIP712 domain.
NOTE: By default this function reads _name which is an immutable value.
It only reads from storage if necessary (in case the value is too large to fit in a ShortString).</em></p>
<pre><code class="language-solidity">function _EIP712Name() internal view returns (string memory);
</code></pre>
<h3 id="_eip712version"><a class="header" href="#_eip712version">_EIP712Version</a></h3>
<p><em>The version parameter for the EIP712 domain.
NOTE: By default this function reads _version which is an immutable value.
It only reads from storage if necessary (in case the value is too large to fit in a ShortString).</em></p>
<pre><code class="language-solidity">function _EIP712Version() internal view returns (string memory);
</code></pre>
<h3 id="_builddomainseparator"><a class="header" href="#_builddomainseparator">_buildDomainSeparator</a></h3>
<pre><code class="language-solidity">function _buildDomainSeparator() private view returns (bytes32);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="erc20discountedbalances"><a class="header" href="#erc20discountedbalances">ERC20DiscountedBalances</a></h1>
<p><a href="https://github.com/aboutcircles/circles-contracts-v2/blob/9fbbffb44eda7934ea8adf9354e5f09f6b15b8b2/src/lift/ERC20DiscountedBalances.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="src/lift/ERC20DiscountedBalances.sol//src/lift/ERC20Permit.sol/contract.ERC20Permit.html">ERC20Permit</a>, <a href="src/lift/ERC20DiscountedBalances.sol//src/circles/Demurrage.sol/contract.Demurrage.html">Demurrage</a>, IERC20</p>
<h2 id="state-variables-9"><a class="header" href="#state-variables-9">State Variables</a></h2>
<h3 id="avatar"><a class="header" href="#avatar">avatar</a></h3>
<pre><code class="language-solidity">address public avatar;
</code></pre>
<h3 id="discountedbalances-2"><a class="header" href="#discountedbalances-2">discountedBalances</a></h3>
<p><em>The mapping of addresses to the discounted balances.</em></p>
<pre><code class="language-solidity">mapping(address =&gt; DiscountedBalance) public discountedBalances;
</code></pre>
<h2 id="functions-12"><a class="header" href="#functions-12">Functions</a></h2>
<h3 id="transfer"><a class="header" href="#transfer">transfer</a></h3>
<pre><code class="language-solidity">function transfer(address _to, uint256 _amount) external returns (bool);
</code></pre>
<h3 id="transferfrom"><a class="header" href="#transferfrom">transferFrom</a></h3>
<pre><code class="language-solidity">function transferFrom(address _from, address _to, uint256 _amount) external returns (bool);
</code></pre>
<h3 id="approve"><a class="header" href="#approve">approve</a></h3>
<pre><code class="language-solidity">function approve(address _spender, uint256 _amount) external returns (bool);
</code></pre>
<h3 id="increaseallowance"><a class="header" href="#increaseallowance">increaseAllowance</a></h3>
<pre><code class="language-solidity">function increaseAllowance(address _spender, uint256 _addedValue) external returns (bool);
</code></pre>
<h3 id="decreaseallowance"><a class="header" href="#decreaseallowance">decreaseAllowance</a></h3>
<pre><code class="language-solidity">function decreaseAllowance(address _spender, uint256 _subtractedValue) external returns (bool);
</code></pre>
<h3 id="balanceof-1"><a class="header" href="#balanceof-1">balanceOf</a></h3>
<pre><code class="language-solidity">function balanceOf(address _account) external view returns (uint256);
</code></pre>
<h3 id="allowance"><a class="header" href="#allowance">allowance</a></h3>
<pre><code class="language-solidity">function allowance(address _owner, address _spender) external view returns (uint256);
</code></pre>
<h3 id="totalsupply-2"><a class="header" href="#totalsupply-2">totalSupply</a></h3>
<pre><code class="language-solidity">function totalSupply() external view virtual returns (uint256);
</code></pre>
<h3 id="balanceofonday-1"><a class="header" href="#balanceofonday-1">balanceOfOnDay</a></h3>
<pre><code class="language-solidity">function balanceOfOnDay(address _account, uint64 _day)
    public
    view
    returns (uint256 balanceOnDay_, uint256 discountCost_);
</code></pre>
<h3 id="_inflationarybalanceof-1"><a class="header" href="#_inflationarybalanceof-1">_inflationaryBalanceOf</a></h3>
<pre><code class="language-solidity">function _inflationaryBalanceOf(address _account) internal view returns (uint256);
</code></pre>
<h3 id="_updatebalance-1"><a class="header" href="#_updatebalance-1">_updateBalance</a></h3>
<pre><code class="language-solidity">function _updateBalance(address _account, uint256 _balance, uint64 _day) internal;
</code></pre>
<h3 id="_discountandaddtobalance-1"><a class="header" href="#_discountandaddtobalance-1">_discountAndAddToBalance</a></h3>
<pre><code class="language-solidity">function _discountAndAddToBalance(address _account, uint256 _value, uint64 _day) internal;
</code></pre>
<h3 id="_transfer"><a class="header" href="#_transfer">_transfer</a></h3>
<pre><code class="language-solidity">function _transfer(address _from, address _to, uint256 _amount) internal;
</code></pre>
<h3 id="_mint-1"><a class="header" href="#_mint-1">_mint</a></h3>
<pre><code class="language-solidity">function _mint(address _owner, uint256 _amount) internal;
</code></pre>
<h3 id="_burn-1"><a class="header" href="#_burn-1">_burn</a></h3>
<pre><code class="language-solidity">function _burn(address _owner, uint256 _amount) internal;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="erc20inflationarybalances"><a class="header" href="#erc20inflationarybalances">ERC20InflationaryBalances</a></h1>
<p><a href="https://github.com/aboutcircles/circles-contracts-v2/blob/9fbbffb44eda7934ea8adf9354e5f09f6b15b8b2/src/lift/ERC20InflationaryBalances.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="src/lift/ERC20InflationaryBalances.sol//src/lift/ERC20Permit.sol/contract.ERC20Permit.html">ERC20Permit</a>, <a href="src/lift/ERC20InflationaryBalances.sol//src/circles/Demurrage.sol/contract.Demurrage.html">Demurrage</a>, IERC20</p>
<h2 id="state-variables-10"><a class="header" href="#state-variables-10">State Variables</a></h2>
<h3 id="extended_accuracy_bits"><a class="header" href="#extended_accuracy_bits">EXTENDED_ACCURACY_BITS</a></h3>
<pre><code class="language-solidity">uint8 internal constant EXTENDED_ACCURACY_BITS = 64;
</code></pre>
<h3 id="_extendedtotalsupply"><a class="header" href="#_extendedtotalsupply">_extendedTotalSupply</a></h3>
<pre><code class="language-solidity">uint256 internal _extendedTotalSupply;
</code></pre>
<h3 id="_extendedaccuracybalances"><a class="header" href="#_extendedaccuracybalances">_extendedAccuracyBalances</a></h3>
<pre><code class="language-solidity">mapping(address =&gt; uint256) private _extendedAccuracyBalances;
</code></pre>
<h2 id="functions-13"><a class="header" href="#functions-13">Functions</a></h2>
<h3 id="transfer-1"><a class="header" href="#transfer-1">transfer</a></h3>
<pre><code class="language-solidity">function transfer(address _to, uint256 _amount) external returns (bool);
</code></pre>
<h3 id="transferfrom-1"><a class="header" href="#transferfrom-1">transferFrom</a></h3>
<pre><code class="language-solidity">function transferFrom(address _from, address _to, uint256 _amount) external returns (bool);
</code></pre>
<h3 id="approve-1"><a class="header" href="#approve-1">approve</a></h3>
<pre><code class="language-solidity">function approve(address _spender, uint256 _amount) external returns (bool);
</code></pre>
<h3 id="increaseallowance-1"><a class="header" href="#increaseallowance-1">increaseAllowance</a></h3>
<pre><code class="language-solidity">function increaseAllowance(address _spender, uint256 _addedValue) external returns (bool);
</code></pre>
<h3 id="decreaseallowance-1"><a class="header" href="#decreaseallowance-1">decreaseAllowance</a></h3>
<pre><code class="language-solidity">function decreaseAllowance(address _spender, uint256 _subtractedValue) external returns (bool);
</code></pre>
<h3 id="balanceof-2"><a class="header" href="#balanceof-2">balanceOf</a></h3>
<pre><code class="language-solidity">function balanceOf(address _account) external view returns (uint256);
</code></pre>
<h3 id="allowance-1"><a class="header" href="#allowance-1">allowance</a></h3>
<pre><code class="language-solidity">function allowance(address _owner, address _spender) external view returns (uint256);
</code></pre>
<h3 id="totalsupply-3"><a class="header" href="#totalsupply-3">totalSupply</a></h3>
<pre><code class="language-solidity">function totalSupply() external view returns (uint256);
</code></pre>
<h3 id="_converttoextended"><a class="header" href="#_converttoextended">_convertToExtended</a></h3>
<pre><code class="language-solidity">function _convertToExtended(uint256 _amount) internal pure returns (uint256);
</code></pre>
<h3 id="_transfer-1"><a class="header" href="#_transfer-1">_transfer</a></h3>
<pre><code class="language-solidity">function _transfer(address _from, address _to, uint256 _amount) internal;
</code></pre>
<h3 id="_mintfromdemurragedamount"><a class="header" href="#_mintfromdemurragedamount">_mintFromDemurragedAmount</a></h3>
<pre><code class="language-solidity">function _mintFromDemurragedAmount(address _owner, uint256 _demurragedAmount) internal returns (uint256);
</code></pre>
<h3 id="_burn-2"><a class="header" href="#_burn-2">_burn</a></h3>
<pre><code class="language-solidity">function _burn(address _owner, uint256 _amount) internal returns (uint256);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="erc20lift"><a class="header" href="#erc20lift">ERC20Lift</a></h1>
<p><a href="https://github.com/aboutcircles/circles-contracts-v2/blob/9fbbffb44eda7934ea8adf9354e5f09f6b15b8b2/src/lift/ERC20Lift.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="src/lift/ERC20Lift.sol//src/proxy/ProxyFactory.sol/contract.ProxyFactory.html">ProxyFactory</a>, <a href="src/lift/ERC20Lift.sol//src/lift/IERC20Lift.sol/interface.IERC20Lift.html">IERC20Lift</a>, <a href="src/lift/ERC20Lift.sol//src/errors/Errors.sol/interface.ICirclesErrors.html">ICirclesErrors</a></p>
<h2 id="state-variables-11"><a class="header" href="#state-variables-11">State Variables</a></h2>
<h3 id="erc20_wrapper_setup_callprefix"><a class="header" href="#erc20_wrapper_setup_callprefix">ERC20_WRAPPER_SETUP_CALLPREFIX</a></h3>
<pre><code class="language-solidity">bytes4 public constant ERC20_WRAPPER_SETUP_CALLPREFIX = bytes4(keccak256("setup(address,address,address)"));
</code></pre>
<h3 id="hub-2"><a class="header" href="#hub-2">hub</a></h3>
<pre><code class="language-solidity">IHubV2 public hub;
</code></pre>
<h3 id="nameregistry-2"><a class="header" href="#nameregistry-2">nameRegistry</a></h3>
<pre><code class="language-solidity">INameRegistry public nameRegistry;
</code></pre>
<h3 id="mastercopyerc20wrapper"><a class="header" href="#mastercopyerc20wrapper">masterCopyERC20Wrapper</a></h3>
<p><em>The master copy of the ERC20 demurrage and inflation Circles contract.</em></p>
<pre><code class="language-solidity">address[2] public masterCopyERC20Wrapper;
</code></pre>
<h3 id="erc20circles"><a class="header" href="#erc20circles">erc20Circles</a></h3>
<pre><code class="language-solidity">mapping(CirclesType =&gt; mapping(address =&gt; address)) public erc20Circles;
</code></pre>
<h2 id="functions-14"><a class="header" href="#functions-14">Functions</a></h2>
<h3 id="constructor-7"><a class="header" href="#constructor-7">constructor</a></h3>
<pre><code class="language-solidity">constructor(
    IHubV2 _hub,
    INameRegistry _nameRegistry,
    address _masterCopyERC20Demurrage,
    address _masterCopyERC20Inflation
);
</code></pre>
<h3 id="ensureerc20"><a class="header" href="#ensureerc20">ensureERC20</a></h3>
<pre><code class="language-solidity">function ensureERC20(address _avatar, CirclesType _circlesType) public returns (address);
</code></pre>
<h3 id="_deployerc20"><a class="header" href="#_deployerc20">_deployERC20</a></h3>
<pre><code class="language-solidity">function _deployERC20(address _masterCopy, address _avatar) internal returns (address);
</code></pre>
<h2 id="events-4"><a class="header" href="#events-4">Events</a></h2>
<h3 id="erc20wrapperdeployed"><a class="header" href="#erc20wrapperdeployed">ERC20WrapperDeployed</a></h3>
<pre><code class="language-solidity">event ERC20WrapperDeployed(address indexed avatar, address indexed erc20Wrapper, CirclesType circlesType);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="erc20permit"><a class="header" href="#erc20permit">ERC20Permit</a></h1>
<p><a href="https://github.com/aboutcircles/circles-contracts-v2/blob/9fbbffb44eda7934ea8adf9354e5f09f6b15b8b2/src/lift/ERC20Permit.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="src/lift/ERC20Permit.sol//src/lift/EIP712.sol/abstract.EIP712.html">EIP712</a>, Nonces, IERC20Permit, IERC20Errors, <a href="src/lift/ERC20Permit.sol//src/errors/Errors.sol/interface.ICirclesErrors.html">ICirclesErrors</a></p>
<h2 id="state-variables-12"><a class="header" href="#state-variables-12">State Variables</a></h2>
<h3 id="permit_typehash"><a class="header" href="#permit_typehash">PERMIT_TYPEHASH</a></h3>
<pre><code class="language-solidity">bytes32 private constant PERMIT_TYPEHASH =
    keccak256("Permit(address owner,address spender,uint256 value,uint256 nonce,uint256 deadline)");
</code></pre>
<h3 id="permitname"><a class="header" href="#permitname">permitName</a></h3>
<pre><code class="language-solidity">string private constant permitName = "Circles";
</code></pre>
<h3 id="permitversion"><a class="header" href="#permitversion">permitVersion</a></h3>
<pre><code class="language-solidity">string private constant permitVersion = "v2";
</code></pre>
<h3 id="_allowances"><a class="header" href="#_allowances">_allowances</a></h3>
<pre><code class="language-solidity">mapping(address =&gt; mapping(address =&gt; uint256)) internal _allowances;
</code></pre>
<h2 id="functions-15"><a class="header" href="#functions-15">Functions</a></h2>
<h3 id="constructor-8"><a class="header" href="#constructor-8">constructor</a></h3>
<pre><code class="language-solidity">constructor();
</code></pre>
<h3 id="_setuppermit"><a class="header" href="#_setuppermit">_setupPermit</a></h3>
<pre><code class="language-solidity">function _setupPermit() internal;
</code></pre>
<h3 id="permit"><a class="header" href="#permit">permit</a></h3>
<pre><code class="language-solidity">function permit(address _owner, address _spender, uint256 _value, uint256 _deadline, uint8 _v, bytes32 _r, bytes32 _s)
    external;
</code></pre>
<h3 id="nonces"><a class="header" href="#nonces">nonces</a></h3>
<pre><code class="language-solidity">function nonces(address _owner) public view override(IERC20Permit, Nonces) returns (uint256);
</code></pre>
<h3 id="domain_separator"><a class="header" href="#domain_separator">DOMAIN_SEPARATOR</a></h3>
<pre><code class="language-solidity">function DOMAIN_SEPARATOR() public view override returns (bytes32);
</code></pre>
<h3 id="_approve"><a class="header" href="#_approve">_approve</a></h3>
<pre><code class="language-solidity">function _approve(address _owner, address _spender, uint256 _amount) internal;
</code></pre>
<h3 id="_spendallowance"><a class="header" href="#_spendallowance">_spendAllowance</a></h3>
<pre><code class="language-solidity">function _spendAllowance(address _owner, address _spender, uint256 _amount) internal;
</code></pre>
<h2 id="errors-5"><a class="header" href="#errors-5">Errors</a></h2>
<h3 id="erc2612expiredsignature"><a class="header" href="#erc2612expiredsignature">ERC2612ExpiredSignature</a></h3>
<p><em>Permit deadline has expired.</em></p>
<pre><code class="language-solidity">error ERC2612ExpiredSignature(uint256 deadline);
</code></pre>
<h3 id="erc2612invalidsigner"><a class="header" href="#erc2612invalidsigner">ERC2612InvalidSigner</a></h3>
<p><em>Mismatched signature.</em></p>
<pre><code class="language-solidity">error ERC2612InvalidSigner(address signer, address owner);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="circlestype"><a class="header" href="#circlestype">CirclesType</a></h1>
<p><a href="https://github.com/aboutcircles/circles-contracts-v2/blob/9fbbffb44eda7934ea8adf9354e5f09f6b15b8b2/src/lift/IERC20Lift.sol">Git Source</a></p>
<pre><code class="language-solidity">enum CirclesType {
    Demurrage,
    Inflation
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ierc20lift"><a class="header" href="#ierc20lift">IERC20Lift</a></h1>
<p><a href="https://github.com/aboutcircles/circles-contracts-v2/blob/9fbbffb44eda7934ea8adf9354e5f09f6b15b8b2/src/lift/IERC20Lift.sol">Git Source</a></p>
<h2 id="functions-16"><a class="header" href="#functions-16">Functions</a></h2>
<h3 id="ensureerc20-1"><a class="header" href="#ensureerc20-1">ensureERC20</a></h3>
<pre><code class="language-solidity">function ensureERC20(address avatar, CirclesType circlesType) external returns (address);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="inflationarycircles"><a class="header" href="#inflationarycircles">InflationaryCircles</a></h1>
<p><a href="https://github.com/aboutcircles/circles-contracts-v2/blob/9fbbffb44eda7934ea8adf9354e5f09f6b15b8b2/src/lift/InflationaryCircles.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="src/lift/InflationaryCircles.sol//src/proxy/MasterCopyNonUpgradable.sol/contract.MasterCopyNonUpgradable.html">MasterCopyNonUpgradable</a>, <a href="src/lift/InflationaryCircles.sol//src/lift/ERC20InflationaryBalances.sol/contract.ERC20InflationaryBalances.html">ERC20InflationaryBalances</a>, ERC1155Holder</p>
<h2 id="state-variables-13"><a class="header" href="#state-variables-13">State Variables</a></h2>
<h3 id="hub-3"><a class="header" href="#hub-3">hub</a></h3>
<pre><code class="language-solidity">IHubV2 public hub;
</code></pre>
<h3 id="nameregistry-3"><a class="header" href="#nameregistry-3">nameRegistry</a></h3>
<pre><code class="language-solidity">INameRegistry public nameRegistry;
</code></pre>
<h3 id="avatar-1"><a class="header" href="#avatar-1">avatar</a></h3>
<pre><code class="language-solidity">address public avatar;
</code></pre>
<h2 id="functions-17"><a class="header" href="#functions-17">Functions</a></h2>
<h3 id="onlyhub-1"><a class="header" href="#onlyhub-1">onlyHub</a></h3>
<pre><code class="language-solidity">modifier onlyHub(uint8 _code);
</code></pre>
<h3 id="constructor-9"><a class="header" href="#constructor-9">constructor</a></h3>
<pre><code class="language-solidity">constructor();
</code></pre>
<h3 id="setup-1"><a class="header" href="#setup-1">setup</a></h3>
<pre><code class="language-solidity">function setup(address _hub, address _nameRegistry, address _avatar) external;
</code></pre>
<h3 id="unwrap-1"><a class="header" href="#unwrap-1">unwrap</a></h3>
<pre><code class="language-solidity">function unwrap(uint256 _amount) external;
</code></pre>
<h3 id="name-1"><a class="header" href="#name-1">name</a></h3>
<pre><code class="language-solidity">function name() external view returns (string memory);
</code></pre>
<h3 id="symbol-1"><a class="header" href="#symbol-1">symbol</a></h3>
<pre><code class="language-solidity">function symbol() external view returns (string memory);
</code></pre>
<h3 id="decimals-2"><a class="header" href="#decimals-2">decimals</a></h3>
<pre><code class="language-solidity">function decimals() external pure returns (uint8);
</code></pre>
<h3 id="onerc1155received-1"><a class="header" href="#onerc1155received-1">onERC1155Received</a></h3>
<pre><code class="language-solidity">function onERC1155Received(address, address _from, uint256 _id, uint256 _amount, bytes memory)
    public
    override
    onlyHub(0)
    returns (bytes4);
</code></pre>
<h3 id="onerc1155batchreceived-1"><a class="header" href="#onerc1155batchreceived-1">onERC1155BatchReceived</a></h3>
<pre><code class="language-solidity">function onERC1155BatchReceived(address, address, uint256[] memory, uint256[] memory, bytes memory)
    public
    view
    override
    onlyHub(1)
    returns (bytes4);
</code></pre>
<h3 id="circlesidentifier-1"><a class="header" href="#circlesidentifier-1">circlesIdentifier</a></h3>
<pre><code class="language-solidity">function circlesIdentifier() public view returns (uint256);
</code></pre>
<h2 id="events-5"><a class="header" href="#events-5">Events</a></h2>
<h3 id="depositinflationary"><a class="header" href="#depositinflationary">DepositInflationary</a></h3>
<pre><code class="language-solidity">event DepositInflationary(address indexed account, uint256 amount, uint256 demurragedAmount);
</code></pre>
<h3 id="withdrawinflationary"><a class="header" href="#withdrawinflationary">WithdrawInflationary</a></h3>
<pre><code class="language-solidity">event WithdrawInflationary(address indexed account, uint256 amount, uint256 demurragedAmount);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents-6"><a class="header" href="#contents-6">Contents</a></h1>
<ul>
<li><a href="src/migration/IHub.sol/interface.IHubV1.html">IHubV1</a></li>
<li><a href="src/migration/IToken.sol/interface.ITokenV1.html">ITokenV1</a></li>
<li><a href="src/migration/Migration.sol/contract.Migration.html">Migration</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ihubv1"><a class="header" href="#ihubv1">IHubV1</a></h1>
<p><a href="https://github.com/aboutcircles/circles-contracts-v2/blob/9fbbffb44eda7934ea8adf9354e5f09f6b15b8b2/src/migration/IHub.sol">Git Source</a></p>
<p><strong>Author:</strong>
Circles</p>
<p>legacy interface of Hub contract in Circles v1</p>
<h2 id="functions-18"><a class="header" href="#functions-18">Functions</a></h2>
<h3 id="signup"><a class="header" href="#signup">signup</a></h3>
<pre><code class="language-solidity">function signup() external;
</code></pre>
<h3 id="signupbonus"><a class="header" href="#signupbonus">signupBonus</a></h3>
<pre><code class="language-solidity">function signupBonus() external view returns (uint256);
</code></pre>
<h3 id="organizationsignup"><a class="header" href="#organizationsignup">organizationSignup</a></h3>
<pre><code class="language-solidity">function organizationSignup() external;
</code></pre>
<h3 id="symbol-2"><a class="header" href="#symbol-2">symbol</a></h3>
<pre><code class="language-solidity">function symbol() external view returns (string memory);
</code></pre>
<h3 id="name-2"><a class="header" href="#name-2">name</a></h3>
<pre><code class="language-solidity">function name() external view returns (string memory);
</code></pre>
<h3 id="tokentouser"><a class="header" href="#tokentouser">tokenToUser</a></h3>
<pre><code class="language-solidity">function tokenToUser(address token) external view returns (address);
</code></pre>
<h3 id="usertotoken"><a class="header" href="#usertotoken">userToToken</a></h3>
<pre><code class="language-solidity">function userToToken(address user) external view returns (address);
</code></pre>
<h3 id="limits"><a class="header" href="#limits">limits</a></h3>
<pre><code class="language-solidity">function limits(address truster, address trustee) external returns (uint256);
</code></pre>
<h3 id="trust-2"><a class="header" href="#trust-2">trust</a></h3>
<pre><code class="language-solidity">function trust(address trustee, uint256 limit) external;
</code></pre>
<h3 id="deployedat"><a class="header" href="#deployedat">deployedAt</a></h3>
<pre><code class="language-solidity">function deployedAt() external view returns (uint256);
</code></pre>
<h3 id="initialissuance"><a class="header" href="#initialissuance">initialIssuance</a></h3>
<pre><code class="language-solidity">function initialIssuance() external view returns (uint256);
</code></pre>
<h3 id="issuance"><a class="header" href="#issuance">issuance</a></h3>
<pre><code class="language-solidity">function issuance() external view returns (uint256);
</code></pre>
<h3 id="issuancebystep"><a class="header" href="#issuancebystep">issuanceByStep</a></h3>
<pre><code class="language-solidity">function issuanceByStep(uint256 periods) external view returns (uint256);
</code></pre>
<h3 id="inflate"><a class="header" href="#inflate">inflate</a></h3>
<pre><code class="language-solidity">function inflate(uint256 initial, uint256 periods) external view returns (uint256);
</code></pre>
<h3 id="inflation"><a class="header" href="#inflation">inflation</a></h3>
<pre><code class="language-solidity">function inflation() external view returns (uint256);
</code></pre>
<h3 id="divisor"><a class="header" href="#divisor">divisor</a></h3>
<pre><code class="language-solidity">function divisor() external view returns (uint256);
</code></pre>
<h3 id="period"><a class="header" href="#period">period</a></h3>
<pre><code class="language-solidity">function period() external view returns (uint256);
</code></pre>
<h3 id="periods"><a class="header" href="#periods">periods</a></h3>
<pre><code class="language-solidity">function periods() external view returns (uint256);
</code></pre>
<h3 id="timeout"><a class="header" href="#timeout">timeout</a></h3>
<pre><code class="language-solidity">function timeout() external view returns (uint256);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="itokenv1"><a class="header" href="#itokenv1">ITokenV1</a></h1>
<p><a href="https://github.com/aboutcircles/circles-contracts-v2/blob/9fbbffb44eda7934ea8adf9354e5f09f6b15b8b2/src/migration/IToken.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
IERC20</p>
<p><strong>Author:</strong>
Circles UBI</p>
<p>legacy interface of Hub contract in Circles v1</p>
<h2 id="functions-19"><a class="header" href="#functions-19">Functions</a></h2>
<h3 id="owner"><a class="header" href="#owner">owner</a></h3>
<pre><code class="language-solidity">function owner() external view returns (address);
</code></pre>
<h3 id="stop-1"><a class="header" href="#stop-1">stop</a></h3>
<pre><code class="language-solidity">function stop() external;
</code></pre>
<h3 id="stopped-2"><a class="header" href="#stopped-2">stopped</a></h3>
<pre><code class="language-solidity">function stopped() external view returns (bool);
</code></pre>
<h3 id="update"><a class="header" href="#update">update</a></h3>
<pre><code class="language-solidity">function update() external;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="migration-1"><a class="header" href="#migration-1">Migration</a></h1>
<p><a href="https://github.com/aboutcircles/circles-contracts-v2/blob/9fbbffb44eda7934ea8adf9354e5f09f6b15b8b2/src/migration/Migration.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="src/migration/Migration.sol//src/errors/Errors.sol/interface.ICirclesErrors.html">ICirclesErrors</a></p>
<h2 id="state-variables-14"><a class="header" href="#state-variables-14">State Variables</a></h2>
<h3 id="accuracy"><a class="header" href="#accuracy">ACCURACY</a></h3>
<pre><code class="language-solidity">uint256 private constant ACCURACY = uint256(10 ** 8);
</code></pre>
<h3 id="hubv1-1"><a class="header" href="#hubv1-1">hubV1</a></h3>
<p><em>The address of the v1 hub contract.</em></p>
<pre><code class="language-solidity">IHubV1 public immutable hubV1;
</code></pre>
<h3 id="hubv2"><a class="header" href="#hubv2">hubV2</a></h3>
<pre><code class="language-solidity">IHubV2 public hubV2;
</code></pre>
<h3 id="inflationdayzero-2"><a class="header" href="#inflationdayzero-2">inflationDayZero</a></h3>
<pre><code class="language-solidity">uint256 public immutable inflationDayZero;
</code></pre>
<h3 id="period-1"><a class="header" href="#period-1">period</a></h3>
<p><em>Inflationary period of Hub v1 contract</em></p>
<pre><code class="language-solidity">uint256 public immutable period;
</code></pre>
<h2 id="functions-20"><a class="header" href="#functions-20">Functions</a></h2>
<h3 id="constructor-10"><a class="header" href="#constructor-10">constructor</a></h3>
<pre><code class="language-solidity">constructor(IHubV1 _hubV1, IHubV2 _hubV2, uint256 _inflationDayZero);
</code></pre>
<h3 id="migrate-2"><a class="header" href="#migrate-2">migrate</a></h3>
<p>Migrates the given amounts of v1 Circles to v2 Circles.</p>
<pre><code class="language-solidity">function migrate(address[] calldata _avatars, uint256[] calldata _amounts) external returns (uint256[] memory);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_avatars</code></td><td><code>address[]</code></td><td>The avatars to migrate.</td></tr>
<tr><td><code>_amounts</code></td><td><code>uint256[]</code></td><td>The amounts in inflationary v1 units to migrate.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256[]</code></td><td>convertedAmounts The converted amounts of v2 Circles.</td></tr>
</tbody></table>
</div>
<h3 id="convertfromv1todemurrage"><a class="header" href="#convertfromv1todemurrage">convertFromV1ToDemurrage</a></h3>
<p>Converts an amount of v1 Circles to demurrage Circles.</p>
<pre><code class="language-solidity">function convertFromV1ToDemurrage(uint256 _amount) public view returns (uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_amount</code></td><td><code>uint256</code></td><td>The amount of v1 Circles to convert.</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="contents-7"><a class="header" href="#contents-7">Contents</a></h1>
<ul>
<li><a href="src/names/Base58Converter.sol/contract.Base58Converter.html">Base58Converter</a></li>
<li><a href="src/names/INameRegistry.sol/interface.INameRegistry.html">INameRegistry</a></li>
<li><a href="src/names/NameRegistry.sol/contract.NameRegistry.html">NameRegistry</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="base58converter"><a class="header" href="#base58converter">Base58Converter</a></h1>
<p><a href="https://github.com/aboutcircles/circles-contracts-v2/blob/9fbbffb44eda7934ea8adf9354e5f09f6b15b8b2/src/names/Base58Converter.sol">Git Source</a></p>
<h2 id="state-variables-15"><a class="header" href="#state-variables-15">State Variables</a></h2>
<h3 id="alphabet"><a class="header" href="#alphabet">ALPHABET</a></h3>
<pre><code class="language-solidity">string internal constant ALPHABET = "123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";
</code></pre>
<h3 id="fixed_short_name_length"><a class="header" href="#fixed_short_name_length">FIXED_SHORT_NAME_LENGTH</a></h3>
<pre><code class="language-solidity">uint256 internal constant FIXED_SHORT_NAME_LENGTH = 12;
</code></pre>
<h3 id="alphabet_length"><a class="header" href="#alphabet_length">ALPHABET_LENGTH</a></h3>
<pre><code class="language-solidity">uint256 internal constant ALPHABET_LENGTH = 58;
</code></pre>
<h2 id="functions-21"><a class="header" href="#functions-21">Functions</a></h2>
<h3 id="_tobase58"><a class="header" href="#_tobase58">_toBase58</a></h3>
<pre><code class="language-solidity">function _toBase58(uint256 _data) internal pure returns (string memory);
</code></pre>
<h3 id="_tobase58withpadding"><a class="header" href="#_tobase58withpadding">_toBase58WithPadding</a></h3>
<pre><code class="language-solidity">function _toBase58WithPadding(uint256 _data) internal pure returns (string memory);
</code></pre>
<h3 id="_reverse"><a class="header" href="#_reverse">_reverse</a></h3>
<pre><code class="language-solidity">function _reverse(bytes memory _b, uint256 _len) internal pure returns (bytes memory);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="inameregistry"><a class="header" href="#inameregistry">INameRegistry</a></h1>
<p><a href="https://github.com/aboutcircles/circles-contracts-v2/blob/9fbbffb44eda7934ea8adf9354e5f09f6b15b8b2/src/names/INameRegistry.sol">Git Source</a></p>
<h2 id="functions-22"><a class="header" href="#functions-22">Functions</a></h2>
<h3 id="setmetadatadigest"><a class="header" href="#setmetadatadigest">setMetadataDigest</a></h3>
<pre><code class="language-solidity">function setMetadataDigest(address avatar, bytes32 metadataDigest) external;
</code></pre>
<h3 id="registercustomname"><a class="header" href="#registercustomname">registerCustomName</a></h3>
<pre><code class="language-solidity">function registerCustomName(address avatar, string calldata name) external;
</code></pre>
<h3 id="registercustomsymbol"><a class="header" href="#registercustomsymbol">registerCustomSymbol</a></h3>
<pre><code class="language-solidity">function registerCustomSymbol(address avatar, string calldata symbol) external;
</code></pre>
<h3 id="name-3"><a class="header" href="#name-3">name</a></h3>
<pre><code class="language-solidity">function name(address avatar) external view returns (string memory);
</code></pre>
<h3 id="symbol-3"><a class="header" href="#symbol-3">symbol</a></h3>
<pre><code class="language-solidity">function symbol(address avatar) external view returns (string memory);
</code></pre>
<h3 id="getmetadatadigest"><a class="header" href="#getmetadatadigest">getMetadataDigest</a></h3>
<pre><code class="language-solidity">function getMetadataDigest(address _avatar) external view returns (bytes32);
</code></pre>
<h3 id="isvalidname"><a class="header" href="#isvalidname">isValidName</a></h3>
<pre><code class="language-solidity">function isValidName(string calldata name) external pure returns (bool);
</code></pre>
<h3 id="isvalidsymbol"><a class="header" href="#isvalidsymbol">isValidSymbol</a></h3>
<pre><code class="language-solidity">function isValidSymbol(string calldata symbol) external pure returns (bool);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="nameregistry-4"><a class="header" href="#nameregistry-4">NameRegistry</a></h1>
<p><a href="https://github.com/aboutcircles/circles-contracts-v2/blob/9fbbffb44eda7934ea8adf9354e5f09f6b15b8b2/src/names/NameRegistry.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="src/names/NameRegistry.sol//src/names/Base58Converter.sol/contract.Base58Converter.html">Base58Converter</a>, <a href="src/names/NameRegistry.sol//src/names/INameRegistry.sol/interface.INameRegistry.html">INameRegistry</a>, <a href="src/names/NameRegistry.sol//src/errors/Errors.sol/interface.INameRegistryErrors.html">INameRegistryErrors</a>, <a href="src/names/NameRegistry.sol//src/errors/Errors.sol/interface.ICirclesErrors.html">ICirclesErrors</a></p>
<h2 id="state-variables-16"><a class="header" href="#state-variables-16">State Variables</a></h2>
<h3 id="max_short_name"><a class="header" href="#max_short_name">MAX_SHORT_NAME</a></h3>
<p>The last ("biggest") short name that can be assigned is "zzzzzzzzzzzz",
which is 1449225352009601191935 in decimal when converted from base58</p>
<pre><code class="language-solidity">uint72 public constant MAX_SHORT_NAME = uint72(1449225352009601191935);
</code></pre>
<h3 id="default_circles_name_prefix"><a class="header" href="#default_circles_name_prefix">DEFAULT_CIRCLES_NAME_PREFIX</a></h3>
<p>The default name prefix for Circles</p>
<p><em>to test pre-release codes, we use a toy name prefix
so that we can easily identify the test Circles</em></p>
<pre><code class="language-solidity">string public constant DEFAULT_CIRCLES_NAME_PREFIX = "Rings-";
</code></pre>
<h3 id="default_circles_symbol"><a class="header" href="#default_circles_symbol">DEFAULT_CIRCLES_SYMBOL</a></h3>
<p>The default symbol for Circles</p>
<pre><code class="language-solidity">string public constant DEFAULT_CIRCLES_SYMBOL = "RING";
</code></pre>
<h3 id="hub-4"><a class="header" href="#hub-4">hub</a></h3>
<p>The address of the hub contract where the address must have registered first</p>
<pre><code class="language-solidity">IHubV2 public hub;
</code></pre>
<h3 id="shortnames"><a class="header" href="#shortnames">shortNames</a></h3>
<p>a mapping from the avatar address to the assigned name</p>
<p><em>9 bytes or uint72 fit 12 characters in base58 encoding</em></p>
<pre><code class="language-solidity">mapping(address =&gt; uint72) public shortNames;
</code></pre>
<h3 id="shortnametoavatar"><a class="header" href="#shortnametoavatar">shortNameToAvatar</a></h3>
<p>a mapping from the short name to the address</p>
<pre><code class="language-solidity">mapping(uint72 =&gt; address) public shortNameToAvatar;
</code></pre>
<h3 id="customnames"><a class="header" href="#customnames">customNames</a></h3>
<pre><code class="language-solidity">mapping(address =&gt; string) public customNames;
</code></pre>
<h3 id="customsymbols"><a class="header" href="#customsymbols">customSymbols</a></h3>
<pre><code class="language-solidity">mapping(address =&gt; string) public customSymbols;
</code></pre>
<h3 id="avatartometadatadigest"><a class="header" href="#avatartometadatadigest">avatarToMetaDataDigest</a></h3>
<p>avatarToMetaDataDigest is a mapping of avatar to the sha256 digest
of their latest ERC1155 metadata.</p>
<pre><code class="language-solidity">mapping(address =&gt; bytes32) public avatarToMetaDataDigest;
</code></pre>
<h2 id="functions-23"><a class="header" href="#functions-23">Functions</a></h2>
<h3 id="mustberegistered"><a class="header" href="#mustberegistered">mustBeRegistered</a></h3>
<pre><code class="language-solidity">modifier mustBeRegistered(address _avatar, uint8 _code);
</code></pre>
<h3 id="onlyhub-2"><a class="header" href="#onlyhub-2">onlyHub</a></h3>
<pre><code class="language-solidity">modifier onlyHub(uint8 _code);
</code></pre>
<h3 id="constructor-11"><a class="header" href="#constructor-11">constructor</a></h3>
<pre><code class="language-solidity">constructor(IHubV2 _hub);
</code></pre>
<h3 id="registershortname"><a class="header" href="#registershortname">registerShortName</a></h3>
<p>Register a short name for the avatar</p>
<pre><code class="language-solidity">function registerShortName() external mustBeRegistered(msg.sender, 0);
</code></pre>
<h3 id="registershortnamewithnonce"><a class="header" href="#registershortnamewithnonce">registerShortNameWithNonce</a></h3>
<p>Registers a short name for the avatar using a specific nonce if the short name is available</p>
<pre><code class="language-solidity">function registerShortNameWithNonce(uint256 _nonce) external mustBeRegistered(msg.sender, 1);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_nonce</code></td><td><code>uint256</code></td><td>nonce to be used in the calculation</td></tr>
</tbody></table>
</div>
<h3 id="setmetadatadigest-1"><a class="header" href="#setmetadatadigest-1">setMetadataDigest</a></h3>
<pre><code class="language-solidity">function setMetadataDigest(address _avatar, bytes32 _metadataDigest) external onlyHub(0);
</code></pre>
<h3 id="updatemetadatadigest"><a class="header" href="#updatemetadatadigest">updateMetadataDigest</a></h3>
<pre><code class="language-solidity">function updateMetadataDigest(bytes32 _metadataDigest) external mustBeRegistered(msg.sender, 2);
</code></pre>
<h3 id="registercustomname-1"><a class="header" href="#registercustomname-1">registerCustomName</a></h3>
<pre><code class="language-solidity">function registerCustomName(address _avatar, string calldata _name) external onlyHub(1);
</code></pre>
<h3 id="registercustomsymbol-1"><a class="header" href="#registercustomsymbol-1">registerCustomSymbol</a></h3>
<pre><code class="language-solidity">function registerCustomSymbol(address _avatar, string calldata _symbol) external onlyHub(2);
</code></pre>
<h3 id="name-4"><a class="header" href="#name-4">name</a></h3>
<pre><code class="language-solidity">function name(address _avatar) external view mustBeRegistered(_avatar, 3) returns (string memory);
</code></pre>
<h3 id="symbol-4"><a class="header" href="#symbol-4">symbol</a></h3>
<pre><code class="language-solidity">function symbol(address _avatar) external view mustBeRegistered(_avatar, 4) returns (string memory);
</code></pre>
<h3 id="getmetadatadigest-1"><a class="header" href="#getmetadatadigest-1">getMetadataDigest</a></h3>
<pre><code class="language-solidity">function getMetadataDigest(address _avatar) external view returns (bytes32);
</code></pre>
<h3 id="searchshortname"><a class="header" href="#searchshortname">searchShortName</a></h3>
<p>Search for the first available short name for the avatar and return the short name and nonce</p>
<pre><code class="language-solidity">function searchShortName(address _avatar) public view returns (uint72 shortName_, uint256 nonce_);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_avatar</code></td><td><code>address</code></td><td>address for which the name is to be calculated</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>shortName_</code></td><td><code>uint72</code></td><td>short name that can be assigned to the avatar</td></tr>
<tr><td><code>nonce_</code></td><td><code>uint256</code></td><td>nonce for which this name can be assigned</td></tr>
</tbody></table>
</div>
<h3 id="calculateshortnamewithnonce"><a class="header" href="#calculateshortnamewithnonce">calculateShortNameWithNonce</a></h3>
<p>Calculates a short name for the avatar using a nonce</p>
<pre><code class="language-solidity">function calculateShortNameWithNonce(address _avatar, uint256 _nonce) public pure returns (uint72 shortName_);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_avatar</code></td><td><code>address</code></td><td>address for which the short name is to be calculated</td></tr>
<tr><td><code>_nonce</code></td><td><code>uint256</code></td><td>nonce to be used in the calculation</td></tr>
</tbody></table>
</div>
<h3 id="isvalidname-1"><a class="header" href="#isvalidname-1">isValidName</a></h3>
<p><em>checks whether string is a valid name by checking
the length as max 32 bytes and the allowed characters: 0-9, A-Z, a-z, space,
hyphen, underscore, period, parentheses, apostrophe,
ampersand, plus and hash.
This restricts the contract name to a subset of ASCII characters,
and excludes unicode characters for other alphabets and emoticons.
Instead the default ERC1155 metadata read from the IPFS CID registry,
should provide the full display name with unicode characters.
Names are not checked for uniqueness.</em></p>
<pre><code class="language-solidity">function isValidName(string calldata _name) public pure returns (bool);
</code></pre>
<h3 id="isvalidsymbol-1"><a class="header" href="#isvalidsymbol-1">isValidSymbol</a></h3>
<p><em>checks whether string is a valid symbol by checking
the length as max 16 bytes and the allowed characters: 0-9, A-Z, a-z,
hyphen, underscore.</em></p>
<pre><code class="language-solidity">function isValidSymbol(string calldata _symbol) public pure returns (bool);
</code></pre>
<h3 id="_registershortname"><a class="header" href="#_registershortname">_registerShortName</a></h3>
<pre><code class="language-solidity">function _registerShortName() internal;
</code></pre>
<h3 id="_registershortnamewithnonce"><a class="header" href="#_registershortnamewithnonce">_registerShortNameWithNonce</a></h3>
<pre><code class="language-solidity">function _registerShortNameWithNonce(uint256 _nonce) internal;
</code></pre>
<h3 id="_storeshortname"><a class="header" href="#_storeshortname">_storeShortName</a></h3>
<pre><code class="language-solidity">function _storeShortName(address _avatar, uint72 _shortName, uint256 _nonce) internal;
</code></pre>
<h3 id="_getshortorlongname"><a class="header" href="#_getshortorlongname">_getShortOrLongName</a></h3>
<pre><code class="language-solidity">function _getShortOrLongName(address _avatar) internal view returns (string memory);
</code></pre>
<h3 id="_setmetadatadigest"><a class="header" href="#_setmetadatadigest">_setMetadataDigest</a></h3>
<pre><code class="language-solidity">function _setMetadataDigest(address _avatar, bytes32 _metadataDigest) internal;
</code></pre>
<h2 id="events-6"><a class="header" href="#events-6">Events</a></h2>
<h3 id="registershortname-1"><a class="header" href="#registershortname-1">RegisterShortName</a></h3>
<pre><code class="language-solidity">event RegisterShortName(address indexed avatar, uint72 shortName, uint256 nonce);
</code></pre>
<h3 id="updatemetadatadigest-1"><a class="header" href="#updatemetadatadigest-1">UpdateMetadataDigest</a></h3>
<pre><code class="language-solidity">event UpdateMetadataDigest(address indexed avatar, bytes32 metadataDigest);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents-8"><a class="header" href="#contents-8">Contents</a></h1>
<ul>
<li><a href="src/operators/BaseOperator.sol/contract.BaseOperator.html">BaseOperator</a></li>
<li><a href="src/operators/SignedPathOperator.sol/contract.SignedPathOperator.html">SignedPathOperator</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="baseoperator"><a class="header" href="#baseoperator">BaseOperator</a></h1>
<p><a href="https://github.com/aboutcircles/circles-contracts-v2/blob/9fbbffb44eda7934ea8adf9354e5f09f6b15b8b2/src/operators/BaseOperator.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="src/operators/BaseOperator.sol//src/errors/Errors.sol/interface.ICirclesErrors.html">ICirclesErrors</a></p>
<h2 id="state-variables-17"><a class="header" href="#state-variables-17">State Variables</a></h2>
<h3 id="hub-5"><a class="header" href="#hub-5">hub</a></h3>
<pre><code class="language-solidity">IHubV2 public hub;
</code></pre>
<h2 id="functions-24"><a class="header" href="#functions-24">Functions</a></h2>
<h3 id="constructor-12"><a class="header" href="#constructor-12">constructor</a></h3>
<pre><code class="language-solidity">constructor(IHubV2 _hub);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="signedpathoperator"><a class="header" href="#signedpathoperator">SignedPathOperator</a></h1>
<p><a href="https://github.com/aboutcircles/circles-contracts-v2/blob/9fbbffb44eda7934ea8adf9354e5f09f6b15b8b2/src/operators/SignedPathOperator.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="src/operators/SignedPathOperator.sol//src/operators/BaseOperator.sol/contract.BaseOperator.html">BaseOperator</a>, <a href="src/operators/SignedPathOperator.sol//src/hub/TypeDefinitions.sol/contract.TypeDefinitions.html">TypeDefinitions</a></p>
<h2 id="functions-25"><a class="header" href="#functions-25">Functions</a></h2>
<h3 id="constructor-13"><a class="header" href="#constructor-13">constructor</a></h3>
<pre><code class="language-solidity">constructor(IHubV2 _hub) BaseOperator(_hub);
</code></pre>
<h3 id="operatesignedflowmatrix"><a class="header" href="#operatesignedflowmatrix">operateSignedFlowMatrix</a></h3>
<pre><code class="language-solidity">function operateSignedFlowMatrix(
    address[] calldata _flowVertices,
    FlowEdge[] calldata _flow,
    Stream[] calldata _streams,
    bytes calldata _packedCoordinates,
    uint256 _sourceCoordinate
) external;
</code></pre>
<h2 id="errors-6"><a class="header" href="#errors-6">Errors</a></h2>
<h3 id="circlesoperatorinvalidstreamsource"><a class="header" href="#circlesoperatorinvalidstreamsource">CirclesOperatorInvalidStreamSource</a></h3>
<pre><code class="language-solidity">error CirclesOperatorInvalidStreamSource(
    uint256 streamIndex, uint256 singleSourceCoordinate, uint256 streamSourceCoordinate
);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents-9"><a class="header" href="#contents-9">Contents</a></h1>
<ul>
<li><a href="src/proxy/MasterCopyNonUpgradable.sol/contract.MasterCopyNonUpgradable.html">MasterCopyNonUpgradable</a></li>
<li><a href="src/proxy/Proxy.sol/interface.IProxy.html">IProxy</a></li>
<li><a href="src/proxy/Proxy.sol/contract.Proxy.html">Proxy</a></li>
<li><a href="src/proxy/ProxyFactory.sol/contract.ProxyFactory.html">ProxyFactory</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="mastercopynonupgradable"><a class="header" href="#mastercopynonupgradable">MasterCopyNonUpgradable</a></h1>
<p><a href="https://github.com/aboutcircles/circles-contracts-v2/blob/9fbbffb44eda7934ea8adf9354e5f09f6b15b8b2/src/proxy/MasterCopyNonUpgradable.sol">Git Source</a></p>
<h2 id="state-variables-18"><a class="header" href="#state-variables-18">State Variables</a></h2>
<h3 id="reservedstorageslotforproxy"><a class="header" href="#reservedstorageslotforproxy">reservedStorageSlotForProxy</a></h3>
<p><em>This storage variable <em>MUST</em> be the first storage element
for this contract.
A contract acting as a master copy for a proxy contract
inherits from this contract. In inherited contracts list, this
contract <em>MUST</em> be the first one. This would assure that
the storage variable is always the first storage element for
the inherited contract.
The proxy is applied to save gas during deployment, and importantly
the proxy is not upgradable.</em></p>
<pre><code class="language-solidity">address internal reservedStorageSlotForProxy;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="iproxy"><a class="header" href="#iproxy">IProxy</a></h1>
<p><a href="https://github.com/aboutcircles/circles-contracts-v2/blob/9fbbffb44eda7934ea8adf9354e5f09f6b15b8b2/src/proxy/Proxy.sol">Git Source</a></p>
<h2 id="functions-26"><a class="header" href="#functions-26">Functions</a></h2>
<h3 id="mastercopy"><a class="header" href="#mastercopy">masterCopy</a></h3>
<pre><code class="language-solidity">function masterCopy() external view returns (address);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="proxy"><a class="header" href="#proxy">Proxy</a></h1>
<p><a href="https://github.com/aboutcircles/circles-contracts-v2/blob/9fbbffb44eda7934ea8adf9354e5f09f6b15b8b2/src/proxy/Proxy.sol">Git Source</a></p>
<p><strong>Authors:</strong>
Stefan George - <a href="mailto:src/proxy/Proxy.sol/stefan@gnosis.io">stefan@gnosis.io</a>, Richard Meissner - <a href="mailto:src/proxy/Proxy.sol/richard@gnosis.io">richard@gnosis.io</a></p>
<h2 id="state-variables-19"><a class="header" href="#state-variables-19">State Variables</a></h2>
<h3 id="mastercopy-1"><a class="header" href="#mastercopy-1">masterCopy</a></h3>
<pre><code class="language-solidity">address public masterCopy;
</code></pre>
<h2 id="functions-27"><a class="header" href="#functions-27">Functions</a></h2>
<h3 id="constructor-14"><a class="header" href="#constructor-14">constructor</a></h3>
<p><em>Constructor function sets address of master copy contract.</em></p>
<pre><code class="language-solidity">constructor(address _masterCopy);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_masterCopy</code></td><td><code>address</code></td><td>Master copy address.</td></tr>
</tbody></table>
</div>
<h3 id="fallback"><a class="header" href="#fallback">fallback</a></h3>
<pre><code class="language-solidity">fallback() external payable;
</code></pre>
<h3 id="receive"><a class="header" href="#receive">receive</a></h3>
<pre><code class="language-solidity">receive() external payable;
</code></pre>
<h3 id="_fallback"><a class="header" href="#_fallback">_fallback</a></h3>
<p><em>Fallback function forwards all transactions and
returns all received return data.</em></p>
<pre><code class="language-solidity">function _fallback() internal;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="proxyfactory"><a class="header" href="#proxyfactory">ProxyFactory</a></h1>
<p><a href="https://github.com/aboutcircles/circles-contracts-v2/blob/9fbbffb44eda7934ea8adf9354e5f09f6b15b8b2/src/proxy/ProxyFactory.sol">Git Source</a></p>
<p><strong>Author:</strong>
Stefan George - <a href="mailto:src/proxy/ProxyFactory.sol/stefan@gnosis.pm">stefan@gnosis.pm</a></p>
<h2 id="functions-28"><a class="header" href="#functions-28">Functions</a></h2>
<h3 id="_createproxy"><a class="header" href="#_createproxy">_createProxy</a></h3>
<p><em>Allows to create new proxy contact and
execute a message call to the new proxy within one transaction.</em></p>
<pre><code class="language-solidity">function _createProxy(address masterCopy, bytes memory data) internal returns (Proxy proxy);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>masterCopy</code></td><td><code>address</code></td><td>Address of master copy.</td></tr>
<tr><td><code>data</code></td><td><code>bytes</code></td><td>Payload for message call sent to new proxy contract.</td></tr>
</tbody></table>
</div>
<h2 id="events-7"><a class="header" href="#events-7">Events</a></h2>
<h3 id="proxycreation"><a class="header" href="#proxycreation">ProxyCreation</a></h3>
<pre><code class="language-solidity">event ProxyCreation(Proxy proxy, address masterCopy);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents-10"><a class="header" href="#contents-10">Contents</a></h1>
<ul>
<li><a href="src/treasury/IStandardVault.sol/interface.IStandardVault.html">IStandardVault</a></li>
<li><a href="src/treasury/StandardTreasury.sol/contract.StandardTreasury.html">StandardTreasury</a></li>
<li><a href="src/treasury/StandardVault.sol/contract.StandardVault.html">StandardVault</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="istandardvault"><a class="header" href="#istandardvault">IStandardVault</a></h1>
<p><a href="https://github.com/aboutcircles/circles-contracts-v2/blob/9fbbffb44eda7934ea8adf9354e5f09f6b15b8b2/src/treasury/IStandardVault.sol">Git Source</a></p>
<h2 id="functions-29"><a class="header" href="#functions-29">Functions</a></h2>
<h3 id="returncollateral"><a class="header" href="#returncollateral">returnCollateral</a></h3>
<pre><code class="language-solidity">function returnCollateral(address receiver, uint256[] calldata ids, uint256[] calldata values, bytes calldata data)
    external;
</code></pre>
<h3 id="burncollateral"><a class="header" href="#burncollateral">burnCollateral</a></h3>
<pre><code class="language-solidity">function burnCollateral(uint256[] calldata ids, uint256[] calldata values, bytes calldata data) external;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="standardtreasury-1"><a class="header" href="#standardtreasury-1">StandardTreasury</a></h1>
<p><a href="https://github.com/aboutcircles/circles-contracts-v2/blob/9fbbffb44eda7934ea8adf9354e5f09f6b15b8b2/src/treasury/StandardTreasury.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
ERC165, <a href="src/treasury/StandardTreasury.sol//src/proxy/ProxyFactory.sol/contract.ProxyFactory.html">ProxyFactory</a>, <a href="src/treasury/StandardTreasury.sol//src/hub/TypeDefinitions.sol/contract.TypeDefinitions.html">TypeDefinitions</a>, IERC1155Receiver, <a href="src/treasury/StandardTreasury.sol//src/errors/Errors.sol/interface.ICirclesErrors.html">ICirclesErrors</a>, <a href="src/treasury/StandardTreasury.sol//src/errors/Errors.sol/interface.IStandardTreasuryErrors.html">IStandardTreasuryErrors</a></p>
<h2 id="state-variables-20"><a class="header" href="#state-variables-20">State Variables</a></h2>
<h3 id="standard_vault_setup_callprefix"><a class="header" href="#standard_vault_setup_callprefix">STANDARD_VAULT_SETUP_CALLPREFIX</a></h3>
<p><em>The call prefix for the setup function on the vault contract</em></p>
<pre><code class="language-solidity">bytes4 public constant STANDARD_VAULT_SETUP_CALLPREFIX = bytes4(keccak256("setup(address)"));
</code></pre>
<h3 id="hub-6"><a class="header" href="#hub-6">hub</a></h3>
<p>Address of the hub contract</p>
<pre><code class="language-solidity">IHubV2 public hub;
</code></pre>
<h3 id="mastercopystandardvault"><a class="header" href="#mastercopystandardvault">mastercopyStandardVault</a></h3>
<p>Address of the mastercopy standard vault contract</p>
<pre><code class="language-solidity">address public immutable mastercopyStandardVault;
</code></pre>
<h3 id="vaults"><a class="header" href="#vaults">vaults</a></h3>
<p>Mapping of group address to vault address</p>
<p><em>The vault is the contract that holds the group's collateral
todo: we could use deterministic vault addresses as to not store them
but then we still need to check whether the correct code has been deployed
so we might as well deploy and store the addresses?</em></p>
<pre><code class="language-solidity">mapping(address =&gt; IStandardVault) public vaults;
</code></pre>
<h2 id="functions-30"><a class="header" href="#functions-30">Functions</a></h2>
<h3 id="onlyhub-3"><a class="header" href="#onlyhub-3">onlyHub</a></h3>
<p>Ensure the caller is the hub</p>
<pre><code class="language-solidity">modifier onlyHub();
</code></pre>
<h3 id="constructor-15"><a class="header" href="#constructor-15">constructor</a></h3>
<p>Constructor to create a standard treasury</p>
<pre><code class="language-solidity">constructor(IHubV2 _hub, address _mastercopyStandardVault);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_hub</code></td><td><code>IHubV2</code></td><td>Address of the hub contract</td></tr>
<tr><td><code>_mastercopyStandardVault</code></td><td><code>address</code></td><td>Address of the mastercopy standard vault contract</td></tr>
</tbody></table>
</div>
<h3 id="supportsinterface-1"><a class="header" href="#supportsinterface-1">supportsInterface</a></h3>
<p><em>See <a href="src/treasury/StandardTreasury.sol//lib/forge-std/src/interfaces/IERC165.sol/interface.IERC165.html#supportsinterface">IERC165-supportsInterface</a>.</em></p>
<pre><code class="language-solidity">function supportsInterface(bytes4 interfaceId) public view override(ERC165, IERC165) returns (bool);
</code></pre>
<h3 id="onerc1155received-2"><a class="header" href="#onerc1155received-2">onERC1155Received</a></h3>
<p><em>Exclusively use single received for receiving group Circles to redeem them
for collateral Circles according to the group mint policy</em></p>
<pre><code class="language-solidity">function onERC1155Received(address _operator, address _from, uint256 _id, uint256 _value, bytes calldata _data)
    public
    override
    onlyHub
    returns (bytes4);
</code></pre>
<h3 id="onerc1155batchreceived-2"><a class="header" href="#onerc1155batchreceived-2">onERC1155BatchReceived</a></h3>
<p><em>Exclusively use batch received for receiving collateral Circles
from the hub contract during group minting</em></p>
<pre><code class="language-solidity">function onERC1155BatchReceived(address, address, uint256[] memory _ids, uint256[] memory _values, bytes calldata _data)
    public
    override
    onlyHub
    returns (bytes4);
</code></pre>
<h3 id="_mintbatchgroupcircles"><a class="header" href="#_mintbatchgroupcircles">_mintBatchGroupCircles</a></h3>
<pre><code class="language-solidity">function _mintBatchGroupCircles(uint256[] memory _ids, uint256[] memory _values, address _group, bytes memory _userData)
    internal
    returns (bytes4);
</code></pre>
<h3 id="_mintgroupcircles"><a class="header" href="#_mintgroupcircles">_mintGroupCircles</a></h3>
<pre><code class="language-solidity">function _mintGroupCircles(uint256 _id, uint256 _value, address _group, bytes memory _userData)
    internal
    returns (bytes4);
</code></pre>
<h3 id="_redeemgroupcircles"><a class="header" href="#_redeemgroupcircles">_redeemGroupCircles</a></h3>
<pre><code class="language-solidity">function _redeemGroupCircles(address _operator, address _from, uint256 _id, uint256 _value, bytes calldata _data)
    internal
    returns (bytes4);
</code></pre>
<h3 id="_decodemetadataforgroup"><a class="header" href="#_decodemetadataforgroup">_decodeMetadataForGroup</a></h3>
<p><em>Decode the metadata for the group mint and revert if the type does not match group mint</em></p>
<pre><code class="language-solidity">function _decodeMetadataForGroup(bytes memory _data) internal pure returns (bytes32, address, bytes memory);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_data</code></td><td><code>bytes</code></td><td>Metadata for the group mint</td></tr>
</tbody></table>
</div>
<h3 id="_validatecirclesidtogroup"><a class="header" href="#_validatecirclesidtogroup">_validateCirclesIdToGroup</a></h3>
<p><em>Validate the Circles id to group address</em></p>
<pre><code class="language-solidity">function _validateCirclesIdToGroup(uint256 _id) internal pure returns (address);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_id</code></td><td><code>uint256</code></td><td>Circles identifier</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>address</code></td><td>group Address of the group</td></tr>
</tbody></table>
</div>
<h3 id="_ensurevault"><a class="header" href="#_ensurevault">_ensureVault</a></h3>
<p><em>Ensure the vault exists for the group, and if not deploy it</em></p>
<pre><code class="language-solidity">function _ensureVault(address _group) internal returns (IStandardVault);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_group</code></td><td><code>address</code></td><td>Address of the group</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>IStandardVault</code></td><td>vault Address of the vault</td></tr>
</tbody></table>
</div>
<h3 id="_deployvault"><a class="header" href="#_deployvault">_deployVault</a></h3>
<p><em>Deploy the vault</em></p>
<pre><code class="language-solidity">function _deployVault() internal returns (IStandardVault);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>IStandardVault</code></td><td>vault Address of the vault</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="standardvault"><a class="header" href="#standardvault">StandardVault</a></h1>
<p><a href="https://github.com/aboutcircles/circles-contracts-v2/blob/9fbbffb44eda7934ea8adf9354e5f09f6b15b8b2/src/treasury/StandardVault.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="src/treasury/StandardVault.sol//src/proxy/MasterCopyNonUpgradable.sol/contract.MasterCopyNonUpgradable.html">MasterCopyNonUpgradable</a>, ERC1155Holder, <a href="src/treasury/StandardVault.sol//src/treasury/IStandardVault.sol/interface.IStandardVault.html">IStandardVault</a>, <a href="src/treasury/StandardVault.sol//src/errors/Errors.sol/interface.ICirclesErrors.html">ICirclesErrors</a></p>
<h2 id="state-variables-21"><a class="header" href="#state-variables-21">State Variables</a></h2>
<h3 id="standardtreasury-2"><a class="header" href="#standardtreasury-2">standardTreasury</a></h3>
<p>Address of the standard treasury</p>
<pre><code class="language-solidity">address public standardTreasury;
</code></pre>
<h3 id="hub-7"><a class="header" href="#hub-7">hub</a></h3>
<p>Address of the hub contract</p>
<pre><code class="language-solidity">IHubV2 public hub;
</code></pre>
<h2 id="functions-31"><a class="header" href="#functions-31">Functions</a></h2>
<h3 id="onlytreasury"><a class="header" href="#onlytreasury">onlyTreasury</a></h3>
<p>Ensure the caller is the standard treasury</p>
<pre><code class="language-solidity">modifier onlyTreasury();
</code></pre>
<h3 id="constructor-16"><a class="header" href="#constructor-16">constructor</a></h3>
<p>Constructor to create a standard vault master copy.</p>
<pre><code class="language-solidity">constructor();
</code></pre>
<h3 id="setup-2"><a class="header" href="#setup-2">setup</a></h3>
<p>Setup the vault</p>
<pre><code class="language-solidity">function setup(IHubV2 _hub) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_hub</code></td><td><code>IHubV2</code></td><td>Address of the hub contract</td></tr>
</tbody></table>
</div>
<h3 id="returncollateral-1"><a class="header" href="#returncollateral-1">returnCollateral</a></h3>
<p>Return the collateral to the receiver can only be called by the treasury</p>
<pre><code class="language-solidity">function returnCollateral(address _receiver, uint256[] calldata _ids, uint256[] calldata _values, bytes calldata _data)
    external
    onlyTreasury;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_receiver</code></td><td><code>address</code></td><td>Receivere address of the collateral</td></tr>
<tr><td><code>_ids</code></td><td><code>uint256[]</code></td><td>Circles identifiers of the collateral</td></tr>
<tr><td><code>_values</code></td><td><code>uint256[]</code></td><td>Values of the collateral to be returned</td></tr>
<tr><td><code>_data</code></td><td><code>bytes</code></td><td>Optional data bytes passed to the receiver</td></tr>
</tbody></table>
</div>
<h3 id="burncollateral-1"><a class="header" href="#burncollateral-1">burnCollateral</a></h3>
<p>Burn collateral from the vault can only ve called by the treasury</p>
<pre><code class="language-solidity">function burnCollateral(uint256[] calldata _ids, uint256[] calldata _values, bytes calldata _data)
    external
    onlyTreasury;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_ids</code></td><td><code>uint256[]</code></td><td>Circles identifiers of the collateral</td></tr>
<tr><td><code>_values</code></td><td><code>uint256[]</code></td><td>Values of the collateral to be burnt</td></tr>
<tr><td><code>_data</code></td><td><code>bytes</code></td><td>Optional data bytes passed to the hub and policy for burning</td></tr>
</tbody></table>
</div>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script>
            const wsProtocol = location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsAddress = wsProtocol + "//" + location.host + "/" + "__livereload";
            const socket = new WebSocket(wsAddress);
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->
        <script src="solidity.min.js"></script>

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>
